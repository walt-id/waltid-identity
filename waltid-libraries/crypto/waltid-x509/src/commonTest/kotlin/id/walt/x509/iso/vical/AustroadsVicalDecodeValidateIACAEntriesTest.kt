package id.walt.x509.iso.vical

import id.walt.crypto.keys.jwk.JWKKey
import id.walt.x509.CertificateDer
import id.walt.x509.iso.iaca.parser.IACACertificateParser
import id.walt.x509.iso.iaca.validate.IACAValidationConfig
import id.walt.x509.iso.iaca.validate.IACAValidator
import kotlinx.coroutines.test.runTest
import kotlinx.serialization.json.Json
import okio.ByteString.Companion.toByteString
import kotlin.io.encoding.Base64
import kotlin.test.Test
import kotlin.test.assertFails

class AustroadsVicalDecodeValidateIACAEntriesTest {

    companion object {

        private val iacaParser = IACACertificateParser()
        private val validator = IACAValidator()

        /**
         * List of cherry-picked base64-encoded DER IACA certificates pulled from the Austroads Pre-Production VICAL.
         * Original list of certificates was pulled from Mattr's "CAL Viewer" tool available (at the time of writing) on
         * the following URL: https://tools.mattrlabs.com/vical-viewer
         * The resulting list (below) was produced by filtering-out IACA certificates that:
         * 1. Use brainpool curves (which waltid-crypto does not support)
         * 2. Expire in less than a year (give or take ;)) at the time of the list's compilation
         * 3. Have the KeyUsage extension marked as "non-critical" -> refer to the other test case in this file
         * 4. Have 'ZZ' as country code -> refer to the respective test case in this file for more info
         * */
        private val iacaPemEncodedCertificates = Json.decodeFromString<List<String>>(
            """
            [
                "MIICejCCAh+gAwIBAgIQP1fWX6bK5IWafQpOzL3JyjAKBggqhkjOPQQDAjBIMRYwFAYDVQQDDA1JQUNBLVVUQUgtVVNBMREwDwYDVQQKDAhVdGFoIERMRDEOMAwGA1UECAwFVVMtVVQxCzAJBgNVBAYTAlVTMB4XDTI1MDMxMTEyNDkyNVoXDTM0MDYwNzEyNDkyNFowSDEWMBQGA1UEAwwNSUFDQS1VVEFILVVTQTERMA8GA1UECgwIVXRhaCBETEQxDjAMBgNVBAgMBVVTLVVUMQswCQYDVQQGEwJVUzBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABA9gsjBB4V6FtUGvCF/ZuQu65dfWIK87Yr1r4KzBM6LFvwxTB5MoWuS/JjyTZO3fENEFm3TtG+Js7KxIZMDClKyjgeowgecwEgYDVR0TAQH/BAgwBgEB/wIBADAfBgNVHSMEGDAWgBR9Bklm+FL6KtqQNeKXdsOkEUNg3TAnBgNVHRIEIDAehhxodHRwczovL21vYmlsZWRsLnVzL2lhY2EtdXQvMBEGA1UdIAQKMAgwBgYEVR0gADBFBgNVHR8EPjA8MDqgOKA2hjRodHRwOi8vd3d3Lm1vYmlsZWRsLnVzL3V0LWlhY2EvbWRsRFMtVVRBSC1VU0EwMDMuY3JsMB0GA1UdDgQWBBR9Bklm+FL6KtqQNeKXdsOkEUNg3TAOBgNVHQ8BAf8EBAMCAQYwCgYIKoZIzj0EAwIDSQAwRgIhAP2roq3hwjl7IQ9j52KMANKn9L9ornH31k42AAUjYALYAiEAhla2itEIdVuVipPO2JorLhEgkF1FzMIw0ggETTzLmGo=",
                "MIIDRzCCAu2gAwIBAgITVgO3G2afw4UBNWRnxbpYWrG5uTAKBggqhkjOPQQDAjCBnTEOMAwGA1UECBMFVVMtR0ExCzAJBgNVBAYTAlVTMRAwDgYDVQQHEwdDb255ZXJzMS4wLAYDVQQKEyVHZW9yZ2lhIERlcGFydG1lbnQgb2YgRHJpdmVyIFNlcnZpY2VzMQ8wDQYDVQQLEwZEUklWRVMxKzApBgNVBAMTIkdlb3JnaWEgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcNMjQwMzIwMDQwMDAwWhcNMjkwMzIwMDQwMDAwWjCBnTEOMAwGA1UECBMFVVMtR0ExCzAJBgNVBAYTAlVTMRAwDgYDVQQHEwdDb255ZXJzMS4wLAYDVQQKEyVHZW9yZ2lhIERlcGFydG1lbnQgb2YgRHJpdmVyIFNlcnZpY2VzMQ8wDQYDVQQLEwZEUklWRVMxKzApBgNVBAMTIkdlb3JnaWEgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASsRp10nCFKtW6sJL0xMPMKDCkeKFccLdRGKl2gN9tnzGi9aEee3z9S+vOH2EKTxFVmiqEmCS1u5LXCKkLIq+D+o4IBCDCCAQQwDgYDVR0PAQH/BAQDAgEGMBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFK/NJTZCADkKrAM2Djwlii+UBPk1MEgGA1UdEgRBMD+BI2dyb3VwaXRwcm9kdWN0aW9uc3VwcG9ydEBkZHMuZ2EuZ292hhhodHRwczovL2Rkcy5nZW9yZ2lhLmdvdi8wYwYDVR0fBFwwWjBYoFagVIZSaHR0cHM6Ly93cy5kcml2ZXMuZ2EuZ292L1dlYlNlcnZpY2VzL05BL0dTUC9jZXJ0aWZpY2F0ZS9yZXZvY2F0aW9uL3Jldm9jYXRpb25zLmNybDAQBgkrBgEEAYPFIQEEA0dTUDAKBggqhkjOPQQDAgNIADBFAiBsNDY02UQq8xatSFHgcdQY64lL0EaaYKsDQ3AvZGjPgAIhAJtOn2wkum9vlccuEFL8XIgL6XHl2jEQSNKadqLoOk+T",
                "MIICEjCCAbigAwIBAgIJfvZc9sFhCx1XMAoGCCqGSM49BAMCMDsxCzAJBgNVBAYTAlNFMREwDwYDVQQKEwhTY3l0YWxlczEZMBcGA1UEAxMQU2N5dGFsZXMgUm9vdCBDQTAeFw0yNDA5MjkxMTQ2MDBaFw0yOTA5MjkxMTQ2MDBaMDsxCzAJBgNVBAYTAlNFMREwDwYDVQQKEwhTY3l0YWxlczEZMBcGA1UEAxMQU2N5dGFsZXMgUm9vdCBDQTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABBAh0v7pcusUp/MHss9ua62NW4eMX9m+dFrRT4iwlEIddTMQQWqViMpbzz0oh1dkXpqFt0fABMcLjf+7Qgtlx7+jgaQwgaEwEgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQUCA3kUHFROjqL1ETcsFn3hCsSHrAwDgYDVR0PAQH/BAQDAgEGMCIGA1UdEgQbMBmGF2h0dHA6Ly93d3cuc2N5dGFsZXMuY29tMDgGA1UdHwQxMC8wLaAroCmGJ2h0dHBzOi8vc3RhdGljLm1kb2MuaWQvY3JsL3NjeXRhbGVzLmNybDAKBggqhkjOPQQDAgNIADBFAiADDYpH/ueYdURFX/EBFE4s9RYx/viOjSK98iWB4W+z7AIhALai/tZtD4Ly4OuddB2pGq3zqmSlJN/RKrJgHxm3pZei",
                "MIICyjCCAnCgAwIBAgIKUdA0d3FaOnvtXzAKBggqhkjOPQQDAjA6MQswCQYDVQQGEwJOWjErMCkGA1UEAwwiaW50ZXJvcC52aWkuYXUwMS5tYXR0ci5nbG9iYWwgSUFDQTAeFw0yNTEwMjQwMDExMzFaFw0zNTEwMjQwMDAwMDBaMDoxCzAJBgNVBAYTAk5aMSswKQYDVQQDDCJpbnRlcm9wLnZpaS5hdTAxLm1hdHRyLmdsb2JhbCBJQUNBMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAERpFmt6NMic2X/Lrlj4FOum2MUMhv4LohyZMHFQU5/5OxJtMID5xbqbvUJmlMiLboiMAYpP8iLTPg7kuzV0aJzaOCAVwwggFYMB0GA1UdDgQWBBS9Z9b2Ziym46cDWSjWA9GUkzJWZzAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADB7BgNVHR8EdDByMHCgbqBshmpodHRwczovL2ludGVyb3AudmlpLmF1MDEubWF0dHIuZ2xvYmFsL3YyL2NyZWRlbnRpYWxzL21vYmlsZS9pYWNhcy8wM2FiMzI5YS0zYzEwLTRhZjktYmUxOC1iYzkzY2E1OWU0MjkvY3JsMDAGA1UdEgQpMCeGJWh0dHBzOi8vaW50ZXJvcC52aWkuYXUwMS5tYXR0ci5nbG9iYWwwZAYJKwYBBAGD4GpkBFcMVWh0dHBzOi8vaW50ZXJvcC52aWkuYXUwMS5tYXR0ci5nbG9iYWwvdjIvY3JlZGVudGlhbHMvbW9iaWxlL3N0YXR1cy1saXN0cy9kaXN0cmlidXRpb24wCgYIKoZIzj0EAwIDSAAwRQIhANq9JbaOVTP2hORN4ATTUJd+DmjhSXj6aBMGonXymCHbAiAFSmNbfnwPJlq+1HfEOGFJGPKHjLQDOjIbD3deBjn0lA==",
                "MIIDTzCCAvagAwIBAgIUALz9VunJbM8WsRyc10+waZ7TncgwCgYIKoZIzj0EAwIwgZwxDjAMBgNVBAgTBVVTLU1UMQswCQYDVQQGEwJVUzEPMA0GA1UEBxMGSGVsZW5hMSYwJAYDVQQKEx1Nb250YW5hIERlcGFydG1lbnQgb2YgSnVzdGljZTEnMCUGA1UECxMeTW9udGFuYSBNb3RvciBWZWhpY2xlIERpdmlzaW9uMRswGQYDVQQDExJjYXJzd3NucC5kb2ptdC5nb3YwHhcNMjUwNTAyMDYwMDAwWhcNMzAwNTAyMDYwMDAwWjCBnDEOMAwGA1UECBMFVVMtTVQxCzAJBgNVBAYTAlVTMQ8wDQYDVQQHEwZIZWxlbmExJjAkBgNVBAoTHU1vbnRhbmEgRGVwYXJ0bWVudCBvZiBKdXN0aWNlMScwJQYDVQQLEx5Nb250YW5hIE1vdG9yIFZlaGljbGUgRGl2aXNpb24xGzAZBgNVBAMTEmNhcnN3c25wLmRvam10LmdvdjBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABBdxLVV8czFFucq2cRy7ZLkvMScwfq4SgtTu2vhilCFy8BsjSt1QbefFoV+KpPqpCZJLQSWrhSopcS7GkDAgYe6jggESMIIBDjAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQUI0+hpnnb+Y53pVjpRENxe7Xvdc8wOQYDVR0SBDIwMIEaY2Fyc2ludGVyZmFjZXRpY2tldEBtdC5nb3aGEmh0dHBzOi8vbXZkbXQuZ292LzB8BgNVHR8EdTBzMHGgb6BthmtodHRwczovL2NhcnMuZG9qbXQuZ292L2d3cHViL01vYmlsZUNyZWRlbnRpYWwvQ2VydGlmaWNhdGVzL1Jldm9jYXRpb25zLzMyNTk2ZGQyZDIwZjQ4M2M5NzRhMzhjYTEwN2Q1NDNlLmNybDAQBgkrBgEEAYPFIQEEA01KUDAKBggqhkjOPQQDAgNHADBEAiBzw8qDQXADtdQz8KZopvLZZ15G9CD64accLrUYYehkXAIgQiCPWmy2wdDP22dNUnbFRqblP+1K2TYlEV2A789ZOBI=",
                "MIIC5DCCAoqgAwIBAgIKYUzzI7gPkqKIATAKBggqhkjOPQQDAjA/MQswCQYDVQQGEwJOWjEwMC4GA1UEAwwnaW50ZXJvcC52aWkuZWxlY3Ryb24ubWF0dHJsYWJzLm5ldCBJQUNBMB4XDTI1MTAzMDIwNDYyOFoXDTM1MTAzMTAwMDAwMFowPzELMAkGA1UEBhMCTloxMDAuBgNVBAMMJ2ludGVyb3AudmlpLmVsZWN0cm9uLm1hdHRybGFicy5uZXQgSUFDQTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABKc3qtmiJdm4tx29B1sI+7hUMqRn5vvDpAEtiHRsJG1K8Qe0IX1BLhh1jmg2PPpFdoW8cBKH5QI1LrmCiPFNheSjggFsMIIBaDAdBgNVHQ4EFgQUdUrOPnrYQ1Yhr824RwJbTitIPj0wDgYDVR0PAQH/BAQDAgEGMBIGA1UdEwEB/wQIMAYBAf8CAQAwgYAGA1UdHwR5MHcwdaBzoHGGb2h0dHBzOi8vaW50ZXJvcC52aWkuZWxlY3Ryb24ubWF0dHJsYWJzLm5ldC92Mi9jcmVkZW50aWFscy9tb2JpbGUvaWFjYXMvY2M5MDE1YzItZDc5Mi00YmE2LThiZDEtMWZjM2RmMmVlOGVkL2NybDA1BgNVHRIELjAshipodHRwczovL2ludGVyb3AudmlpLmVsZWN0cm9uLm1hdHRybGFicy5uZXQwaQYJKwYBBAGD4GpkBFwMWmh0dHBzOi8vaW50ZXJvcC52aWkuZWxlY3Ryb24ubWF0dHJsYWJzLm5ldC92Mi9jcmVkZW50aWFscy9tb2JpbGUvc3RhdHVzLWxpc3RzL2Rpc3RyaWJ1dGlvbjAKBggqhkjOPQQDAgNIADBFAiEAwHuq/F8VypvZ5T3ViFpf5OwFuuIHUAaAIHPvG341gAICIBl7Pu7vUdrfqCLJEDsKCAKwhveGngpmWxyCCRAprji9",
                "MIIC5jCCAmygAwIBAgIRALx1kgxevAyQv4ja0Ojs/ZAwCgYIKoZIzj0EAwMwXzEvMC0GA1UEAwwmTG91aXNpYW5hIERlcGFydG1lbnQgb2YgTW90b3IgVmVoaWNsZXMxEjAQBgNVBAoMCUxBIFdhbGxldDELMAkGA1UECAwCTEExCzAJBgNVBAYTAlVTMB4XDTIzMDkwNzAwMDAwMFoXDTI4MDgxMjAwMDAwMFowXzEvMC0GA1UEAwwmTG91aXNpYW5hIERlcGFydG1lbnQgb2YgTW90b3IgVmVoaWNsZXMxEjAQBgNVBAoMCUxBIFdhbGxldDELMAkGA1UECAwCTEExCzAJBgNVBAYTAlVTMHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEHOUM2Naj4sPC/2nNPyOvaXF7vRMceG7rhVOW8pAS6y55FHnJHeHb/MLF+vadwQcrPhp0eM67QVcRqRvzJYsePuN8maDRhsUJgC1OI+624vAU6I6wbhEymiEi6K4KGGFvo4HrMIHoMBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFDHnw6szJSIvwMU5sFhhNFzSF8VPMA4GA1UdDwEB/wQEAwIBBjBTBgNVHR8ETDBKMEigRqBEhkJodHRwczovL3RydXN0LmxvdWlzaWFuYS5nb3YvcmV2b2NhdGlvbnMvbGEtbURMLWlhY2EtMjAyMy0wOS0wOC5jcmwwTgYDVR0SBEcwRYZDaHR0cHM6Ly90cnVzdC5sb3Vpc2lhbmEuZ292L2NlcnRpZmljYXRlcy9sYS1tREwtaWFjYS0yMDIzLTA5LTA4LmNlcjAKBggqhkjOPQQDAwNoADBlAjEA+8UHRHLLAYy/gwpO3iiUOt1xGEXZzfcIMvjBbHuL8RboSGqJ960JuJtyu5i7S8RRAjBvZPoTmr+82b+Yd2gZS8iCMgHt2PVvRY6wGupQoy0gniORYuiOUcCzcQ2hS4ZgfCs=",
                "MIIDBTCCAqygAwIBAgIUKuFzbunBYUZxFDYKYdPC+unmS/MwCgYIKoZIzj0EAwIwfzESMBAGA1UEAwwJTVZNVGVzdENBMS0wKwYDVQQKDCRBcml6b25hIERlcGFydG1lbnQgb2YgVHJhbnNwb3J0YXRpb24xCzAJBgNVBAsMAklUMQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVVMtQVoxEDAOBgNVBAcMB1Bob2VuaXgwHhcNMjQwNzMwMTY1NDA2WhcNMzQwNzMwMTY1NDA2WjB/MRIwEAYDVQQDDAlNVk1UZXN0Q0ExLTArBgNVBAoMJEFyaXpvbmEgRGVwYXJ0bWVudCBvZiBUcmFuc3BvcnRhdGlvbjELMAkGA1UECwwCSVQxCzAJBgNVBAYTAlVTMQ4wDAYDVQQIDAVVUy1BWjEQMA4GA1UEBwwHUGhvZW5peDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABDMnPWRJsoB6AlkNQO4T7np+K0H2y0l1qiUUHcKyK+8Ue3JDXOBP1/8WMi5ahRP0r40M1koQ7VaVeotgJF/f9gWjggEEMIIBADAdBgNVHQ4EFgQUFG/HSDZGXTdSSgUImYgv8+aSslYwHwYDVR0jBBgwFoAUFG/HSDZGXTdSSgUImYgv8+aSslYwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAQYwLAYDVR0SBCUwI4YhaHR0cHM6Ly9hemRvdC5nb3YvbXZkL2NvbnRhY3QtbXZkMGwGA1UdHwRlMGMwYaBfoF2GW2h0dHBzOi8vbXZtcHVibGljLmJsb2IuY29yZS51c2dvdmNsb3VkYXBpLm5ldC9jZXJ0aWZpY2F0ZS1yZXZvY2F0aW9uLWxpc3QvTVZNUHJvZENBLmNybC5wZW0wCgYIKoZIzj0EAwIDRwAwRAIgdk8IZYQM8svbCTrll+eD+WrI29QPKmSr0VVbk1UYJKACIADEQzO2bcYIgOr+8xj8LIIG7HxBVSLlNmDfed0nDLux",
                "MIICbjCCAhSgAwIBAgIJDY4vb9sj4PTLMAoGCCqGSM49BAMCMEYxCzAJBgNVBAYTAlBIMQ4wDAYDVQQIDAVQSC0wMDELMAkGA1UECgwCREwxCzAJBgNVBAsMAlZSMQ0wCwYDVQQDDARnb0lEMB4XDTI0MDEwOTAwMDAwMFoXDTMzMDEwOTIzNTk1OVowRjELMAkGA1UEBhMCUEgxDjAMBgNVBAgMBVBILTAwMQswCQYDVQQKDAJETDELMAkGA1UECwwCVlIxDTALBgNVBAMMBGdvSUQwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQJ8tbOXpAPblIxbmGFLI0YosOW1XgmgwgQwvn8enIENSowpyd2f6dVqL36ZNPxRtXrZJhTmfYo24dIiPt9RNVko4HqMIHnMBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBQCwqigg1O1afapyqOvMPdUGhT9KjArBgNVHRAEJDAigA8yMDI0MDEwOTAwMDAwMFqBDzIwMjkwMTA5MjM1OTU5WjAkBgNVHRIEHTAbhhlodHRwOi8vd3d3LmhpZGdsb2JhbC5jb20vME8GA1UdHwRIMEYwRKBCoECGPmh0dHBzOi8vZGV2LWxzLmdvaWRodWIuaGlkY2xvdWQuY29tL2NpZC9oaWR0ZXN0aWFjYW1kbC5jcmwucGVtMAoGCCqGSM49BAMCA0gAMEUCIQDCfjRXqUL1sgxqSwMqdQbUm8qLk7kyS2iZdOvtBG8VLgIgL/7CB3UesqScGZTFTRlji1nEY/FF5/Iaqwi8M6NmQWk=",
                "MIIDQjCCAuegAwIBAgIUALj0FeW5Es6+r08rWsHsIA1igMAwCgYIKoZIzj0EAwIwgZ8xDjAMBgNVBAgTBVVTLU5EMQswCQYDVQQGEwJVUzERMA8GA1UEBxMIQmlzbWFyY2sxMjAwBgNVBAoTKU5vcnRoIERha290YSBEZXBhcnRtZW50IG9mIFRyYW5zcG9ydGF0aW9uMQ8wDQYDVQQLEwZMRUdFTkQxKDAmBgNVBAMTH2h0dHBzOi8vcGFydG5lci5tZGwuZG90Lm5kLmdvdi8wHhcNMjUwNjEwMDYwMDAwWhcNMzAwNjEwMDYwMDAwWjCBnzEOMAwGA1UECBMFVVMtTkQxCzAJBgNVBAYTAlVTMREwDwYDVQQHEwhCaXNtYXJjazEyMDAGA1UEChMpTm9ydGggRGFrb3RhIERlcGFydG1lbnQgb2YgVHJhbnNwb3J0YXRpb24xDzANBgNVBAsTBkxFR0VORDEoMCYGA1UEAxMfaHR0cHM6Ly9wYXJ0bmVyLm1kbC5kb3QubmQuZ292LzBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABH7Etk/9zy7wqAwn8Qb1vzhMsx7H7JOYuTUbirPu26Q766Bndw8yyjZTRJp3pZeWWs4TbS668mcI1IUB+0e3gnqjgf4wgfswDgYDVR0PAQH/BAQDAgEGMBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFGgohKo4OSffuHWBD5zP+1RjMCEGMDAGA1UdEgQpMCeBEGRvdG12dGVjaEBuZC5nb3aGE2h0dHBzOi8vZG90Lm5kLmdvdi8wcgYDVR0fBGswaTBnoGWgY4ZhaHR0cHM6Ly9kb3QubmQuZ292L0xFR0VOREVYVC9ETVAvRFNWUy9XZWJTZXJ2aWNlcy9tZGwvdjEvY3JsLzQ5ZDNmOTliMGQwNDQyMDY4ZDVlNzY0NWM0Njc5ZTk4LmNybDAQBgkrBgEEAYPFIQEEA0RNUDAKBggqhkjOPQQDAgNJADBGAiEA8ieW8neYho+hsu4hB2c9rekEh1+GopZ7r8Sz4JU1ctECIQDUGD/4QFHseFdQb/lLDjD6/xUfLfvrPD5my+wMSy8AIA==",
                "MIIDBzCCAqygAwIBAgIUe6dqz3Fm2OsyTbzWzoc1HwZ8Bq8wCgYIKoZIzj0EAwIwfzESMBAGA1UEAwwJTVZNVGVzdENBMS0wKwYDVQQKDCRBcml6b25hIERlcGFydG1lbnQgb2YgVHJhbnNwb3J0YXRpb24xCzAJBgNVBAsMAklUMQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVVMtQVoxEDAOBgNVBAcMB1Bob2VuaXgwHhcNMjQwNzMwMTYxOTU2WhcNMzQwNzMwMTYxOTU2WjB/MRIwEAYDVQQDDAlNVk1UZXN0Q0ExLTArBgNVBAoMJEFyaXpvbmEgRGVwYXJ0bWVudCBvZiBUcmFuc3BvcnRhdGlvbjELMAkGA1UECwwCSVQxCzAJBgNVBAYTAlVTMQ4wDAYDVQQIDAVVUy1BWjEQMA4GA1UEBwwHUGhvZW5peDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABNg3teQ9Jr1scyXzDAQwJDgL+IqOeD9Jp5yxtBjaNYvNSHG7MMUJZups80g2yotUoAwe9t94lv89eCSd+auPb+SjggEEMIIBADAdBgNVHQ4EFgQU7VrHHGCQbGyWDDzc0pgogAEEuhEwHwYDVR0jBBgwFoAU7VrHHGCQbGyWDDzc0pgogAEEuhEwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAQYwLAYDVR0SBCUwI4YhaHR0cHM6Ly9hemRvdC5nb3YvbXZkL2NvbnRhY3QtbXZkMGwGA1UdHwRlMGMwYaBfoF2GW2h0dHBzOi8vbXZtcHVibGljLmJsb2IuY29yZS51c2dvdmNsb3VkYXBpLm5ldC9jZXJ0aWZpY2F0ZS1yZXZvY2F0aW9uLWxpc3QvTVZNUHJvZENBLmNybC5wZW0wCgYIKoZIzj0EAwIDSQAwRgIhANlr4HxxBC6fiDw1mYVyEG+xMOLib1F5PhUAEcyRg2OPAiEA1uvcks4CYxb7EzJC5RcJRAPDpxH3IxFaUiQc+ZgLseg=",
                "MIICXTCCAeKgAwIBAgIUPoLnGds6DJJoa8Q1wFvGjl6rTREwCgYIKoZIzj0EAwMwLjEfMB0GA1UEAwwWUGFuYXNvbmljIENvbm5lY3QgSUFDQTELMAkGA1UEBhMCSlAwHhcNMjUwMzMxMDYxODIwWhcNMzAwODAxMDYxODE5WjAuMR8wHQYDVQQDDBZQYW5hc29uaWMgQ29ubmVjdCBJQUNBMQswCQYDVQQGEwJKUDB2MBAGByqGSM49AgEGBSuBBAAiA2IABLdoILiTNq+1bbtIUnOTnaK8KWbU7hAoxo0Jgs4BEnaExUvvUh128gVXjsCwxCP/+r8Dz8ZRtGeEyl8Sf9O0t+kATtOAvV+Lvnxx06digRU1Jkt3Lwfb9qWroz+2o4VAL6OBwDCBvTASBgNVHRMBAf8ECDAGAQH/AgEAMEwGA1UdHwRFMEMwQaA/oD2GO2h0dHBzOi8vbWRscGlsb3QuamFwYW5lYXN0LmNsb3VkYXBwLmF6dXJlLmNvbS9DUkxzL21kb2MuY3JsMB0GA1UdDgQWBBQQsPCYeOwtEV6xpjwiOgJTwYxMjTAOBgNVHQ8BAf8EBAMCAQYwKgYDVR0SBCMwIYYfaHR0cHM6Ly9tZG9jLnBhbmFzb25pYy5nb3YvbWRvYzAKBggqhkjOPQQDAwNpADBmAjEA8YbSkct8LWZ4HFSSEyI7HFyph+m63RxMapWmUhDFbNilsEnlCEDpqIEivQFD1aQ/AjEA0usFB/4Umx5/b5ZeBNiG+qf7HvS25JI+opgfzCDn15nO9NMnSZ2FjvaannUW4534",
                "MIICGzCCAcCgAwIBAgIISEhveVSLC6EwCgYIKoZIzj0EAwIwPTEgMB4GA1UEAwwXUkRXIEVVRElXIExTUCBURVNUIElBQ0ExDDAKBgNVBAoMA1JEVzELMAkGA1UEBhMCTkwwHhcNMjUwMzEyMDgzNzMyWhcNMzUwMzEwMDgzNzMyWjA9MSAwHgYDVQQDDBdSRFcgRVVESVcgTFNQIFRFU1QgSUFDQTEMMAoGA1UECgwDUkRXMQswCQYDVQQGEwJOTDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABOwLzZk9e/HBrf96KgM20UPAqIOLULenPDmtYE/qvmesvCm/l1x2UIYL0KoSa+EUcl/uUYyMDZ/jvIDDH03EBCajgakwgaYwHQYDVR0OBBYEFIfYF7ERL5A6IS0ZoDBZnC58GgO9MA4GA1UdDwEB/wQEAwIBBjAaBgNVHRIEEzARhg9odHRwczovL3Jkdy5ubC8wEgYDVR0TAQH/BAgwBgEB/wIBADBFBgNVHR8EPjA8MDqgOKA2hjRodHRwczovL21kbGlzc3Vlci5henVyZXdlYnNpdGVzLm5ldC9jcmwvUkRXX0lBQ0EuY3JsMAoGCCqGSM49BAMCA0kAMEYCIQCvYA19hfhSzcmybH1SENlXDUAZlcrANJhuyI+wlFCpmgIhANrVnAED9WjvkVc9XqYgGh7XDVd0nB7nC5DGlB/mIm2H",
                "MIIC4TCCAkKgAwIBAgIJEAAAAAAAAAAAMAoGCCqGSM49BAMEMFUxCzAJBgNVBAYTAkdCMQ8wDQYDVQQIDAZHQi1FREgxDTALBgNVBAoMBEZpbWUxJjAkBgNVBAMMHVRlc3QgSUFDQSBSb290IGNlcnQgMSBmb3IgbURMMB4XDTI0MDcwMjEyMDcxM1oXDTM4MDMxMTEyMDcxM1owVTELMAkGA1UEBhMCR0IxDzANBgNVBAgMBkdCLUVESDENMAsGA1UECgwERmltZTEmMCQGA1UEAwwdVGVzdCBJQUNBIFJvb3QgY2VydCAxIGZvciBtREwwgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABAE1lVpqnTZhSS/uCV3v8EWMe8OIYSZbjPiLZnpEBijxsKlPE9LHENQvva4m5RJgWo6QuNxHs69Dmm21QQpOQrxHPgH9J4VLXcPsDY8CNVC16QrZ7VLqAPZEvl/bYPyz0C2Fk+AyGsFCByP2d1QGP6RIYRmC/JW9sr3AcE559m+VIYe6z6OBtzCBtDAdBgNVHQ4EFgQUJ3XuoRx+JTcvMYg/cDzcz9SPfk4wDgYDVR0PAQH/BAQDAgEGMB4GA1UdEgQXMBWGE2h0dHBzOi8vd3d3Lmlzby5vcmcwEgYDVR0TAQH/BAgwBgEB/wIBADBPBgNVHR8ESDBGMESgQqBAhj5odHRwOi8vbWRsLnNlbGZ0ZXN0cGxhdGZvcm0uY29tL2p1bDI0L2NybC90b29sX2NybF9pYWNhXzAxLmNybDAKBggqhkjOPQQDBAOBjAAwgYgCQgFlq06Ux4mxY3TsLzhEVJo7x5AbeN6Iw5JWXj8KMrrgeoK3Z/2FAFtg9zOI1RJEsoit9fEwsJWKig+gJIAtzj7pEAJCAV+9OJdRWqsrFbJEHTFaGVgUFPyQAQyv0frtCx6bwPuk+of81SGBsv+xIZHrj6boqvY9VSrCoRP8DkjWkV1H26zT",
                "MIIC/jCCAqWgAwIBAgIUAMLBrrtl/kiPRa3nJEt18F/kojAwCgYIKoZIzj0EAwIwgY8xDjAMBgNVBAgTBVVTLUNPMQswCQYDVQQGEwJVUzEPMA0GA1UEBxMGRGVudmVyMScwJQYDVQQKEx5Db2xvcmFkbyBEZXBhcnRtZW50IG9mIFJldmVudWUxEjAQBgNVBAsTCUNPIERSSVZFUzEiMCAGA1UEAxMZQ29sb3JhZG8gUm9vdCBDZXJ0aWZpY2F0ZTAeFw0yNDEwMjkwNjAwMDBaFw0yOTEwMjkwNjAwMDBaMIGPMQ4wDAYDVQQIEwVVUy1DTzELMAkGA1UEBhMCVVMxDzANBgNVBAcTBkRlbnZlcjEnMCUGA1UEChMeQ29sb3JhZG8gRGVwYXJ0bWVudCBvZiBSZXZlbnVlMRIwEAYDVQQLEwlDTyBEUklWRVMxIjAgBgNVBAMTGUNvbG9yYWRvIFJvb3QgQ2VydGlmaWNhdGUwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARuuLSkdRJ4QPEFqbPHmZP8Hbu8waHHJ6wKofZgHg7fOTUT4r+jV+jFpM5dNCbW/mdJyJwRCEsdOs3cvGtolt5No4HcMIHZMA4GA1UdDwEB/wQEAwIBBjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQWBBRuHjVnGUTr6tI5nEkfnK/3EFyP2DAkBgNVHRIEHTAbhhlodHRwczovL2Rtdi5jb2xvcmFkby5nb3YvMFwGA1UdHwRVMFMwUaBPoE2GS2h0dHBzOi8vZGV2Lm1vYmlsZWRsLmNvbS81MHB3cy9DUkwvbURMLzMxOTE0YzI5OWMxMTRhMWQ4ZjE4MTRlZTExOWU1NTdhLmNybDAQBgkrBgEEAYPFIQEEAzUwUDAKBggqhkjOPQQDAgNHADBEAiBr2FEgBjcMyt1WPtiV1tSYAAcP1OxcBofI6NNZbBEXcQIgRWFaTIFbsVXVyouuTnsNCB6JykHPP03sxjkyA/Wd5RE=",
                "MIICYzCCAgmgAwIBAgIKXhjLoCkLWBxREDAKBggqhkjOPQQDAjA4MQswCQYDVQQGEwJBVTEpMCcGA1UEAwwgbW9udGNsaWZmLWRtdi5tYXR0cmxhYnMuY29tIElBQ0EwHhcNMjQwMTE4MjMxNDE4WhcNMzQwMTE1MjMxNDE4WjA4MQswCQYDVQQGEwJBVTEpMCcGA1UEAwwgbW9udGNsaWZmLWRtdi5tYXR0cmxhYnMuY29tIElBQ0EwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASBnqobOh8baMW7mpSZaQMawj6wgM5e5nPd6HXpdB8eUVPlCMKribQ7XiiLU96rib/yQLH2k1CUeZmEjxoEi42xo4H6MIH3MBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBRFZwEOI9yq232NG+OzNQzFKa/LxDAuBgNVHRIEJzAlhiNodHRwczovL21vbnRjbGlmZi1kbXYubWF0dHJsYWJzLmNvbTCBgQYDVR0fBHoweDB2oHSgcoZwaHR0cHM6Ly9tb250Y2xpZmYtZG12LnZpaS5hdTAxLm1hdHRyLmdsb2JhbC92Mi9jcmVkZW50aWFscy9tb2JpbGUvaWFjYXMvMjk0YmExYmMtOTFhMS00MjJmLThhMTctY2IwODU0NWY0ODYwL2NybDAKBggqhkjOPQQDAgNIADBFAiAlZYQP95lGzVJfCykhcpCzpQ2LWE/AbjTGkcGISNsu7gIhAJfP54a2hXz4YiQN4qJERlORjyL1Ru9M0/dtQppohFm6",
                "MIICgTCCAiegAwIBAgIUJutOUJNclipihThCk2Q7lMB7iDYwCgYIKoZIzj0EAwIwVzELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAlNUMQ8wDQYDVQQKDAZJZGVtaWExKjAoBgNVBAMMIVdhbGxldCBRQS1JZGVtaWEgSUFDQSBjZXJ0aWZpY2F0ZTAeFw0yNDA4MjEwOTQyMzVaFw0zMzA4MTkwOTQyMzVaMFcxCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJTVDEPMA0GA1UECgwGSWRlbWlhMSowKAYDVQQDDCFXYWxsZXQgUUEtSWRlbWlhIElBQ0EgY2VydGlmaWNhdGUwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQ6u0P3FiebpEhsmh1XUmC7rMDpUEs0JpnPH9+4F2CnIWc2O5duT7WGekDiRlxuMSGNCbOtPfq5BDO3r/LhxMfko4HQMIHNMB0GA1UdDgQWBBR6BbGqTpxSd8UiuuQPNCxTUCJHRDASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIBBjAhBgNVHRIEGjAYhhZodHRwczovL3d3dy5pZGVtaWEuY29tMGUGA1UdHwReMFwwWqBYoFaGVGh0dHA6Ly9jcmwucmFjLXRlbmFudC5zdGFnaW5nLmlkZW50aXR5LWRldi5pZGVtaWEuaW8vd2FsbGV0LXFhLWlkZW1pYS13YWxsZXQtY3JsLnBlbTAKBggqhkjOPQQDAgNIADBFAiEApwZFMJ4MkB/t+kUk83Pe+gRGD12ssxDEF00ENiso33cCIHcESM6JqD27e6yPLaEc9m9XcaVVehv4PKDl/VlLete6",
                "MIICxjCCAmygAwIBAgITJkV7El8K11IXqY7mz96n/EhiITAKBggqhkjOPQQDAjBqMQ4wDAYDVQQIEwVVUy1NRDELMAkGA1UEBhMCVVMxFDASBgNVBAcTC0dsZW4gQnVybmllMRUwEwYDVQQKEwxNYXJ5bGFuZCBNVkExHjAcBgNVBAMTFUZhc3QgRW50ZXJwcmlzZXMgUm9vdDAeFw0yNDAxMDUwNTAwMDBaFw0yOTAxMDQwNTAwMDBaMGoxDjAMBgNVBAgTBVVTLU1EMQswCQYDVQQGEwJVUzEUMBIGA1UEBxMLR2xlbiBCdXJuaWUxFTATBgNVBAoTDE1hcnlsYW5kIE1WQTEeMBwGA1UEAxMVRmFzdCBFbnRlcnByaXNlcyBSb290MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEaWcKIqlAWboV93RAa5ad0LJBn8W0/yYwtOyUlxuTxoo4SPkorKmOz3EhThC+U4WRrt13aSnCsJtK+waBFghXu6OB8DCB7TAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQUTprRzaFBJ1SLjJsO01tlLCQ4YF0wPAYDVR0SBDUwM4EWbXZhY3NAbWRvdC5zdGF0ZS5tZC51c4YZaHR0cHM6Ly9tdmEubWFyeWxhbmQuZ292LzBYBgNVHR8EUTBPME2gS6BJhkdodHRwczovL215bXZhLm1hcnlsYW5kLmdvdjo1NDQzL01EUC9XZWJTZXJ2aWNlcy9DUkwvbURML3Jldm9jYXRpb25zLmNybDAQBgkrBgEEAYPFIQEEA01EUDAKBggqhkjOPQQDAgNIADBFAiEAnX3+E4E5dQ+5G1rmStJTW79ZAiDTabyL8lJuYL/nDxMCIHHkAyIJcQlQmKDUVkBr3heUd5N9Y8GWdbWnbHuwe7Om",
                "MIIDcDCCAvagAwIBAgIUX9Ek9pKNP/yYUYu9pf6pyxFM2M4wCgYIKoZIzj0EAwMwSTEYMBYGA1UEAwwPQWxhc2thIERNViBJQUNBMRMwEQYDVQQKDApBbGFza2EgRE1WMQswCQYDVQQIDAJBSzELMAkGA1UEBhMCVVMwHhcNMjUwMjEyMjMyMjM4WhcNMzUwMjEwMjMyMjM3WjBJMRgwFgYDVQQDDA9BbGFza2EgRE1WIElBQ0ExEzARBgNVBAoMCkFsYXNrYSBETVYxCzAJBgNVBAgMAkFLMQswCQYDVQQGEwJVUzB2MBAGByqGSM49AgEGBSuBBAAiA2IABDMUuKt2Met/TjeB0klqsmfJyBiyc6liSk8s/R2FSwWJT10AzaWq3t77Fzl5xrUJfXrZOgmAad+R79nfCDKEw9nOUDyPxwnK+x1Tf56IyV9HEV9S5OweERm+HnOLqcYblqOCAZ0wggGZMBIGA1UdEwEB/wQIMAYBAf8CAQAwHwYDVR0jBBgwFoAUnG/8jgGkyjyKsmmZHwRklS8YxNQwMQYDVR0SBCowKIEmdXMuZGlzLm5vcmFtLml0LmFkbWluc0B0aGFsZXNncm91cC5jb20wMQYDVR0RBCowKIEmdXMuZGlzLm5vcmFtLml0LmFkbWluc0B0aGFsZXNncm91cC5jb20wgbAGA1UdHwSBqDCBpTCBoqCBn6CBnIaBmWh0dHA6Ly9pc3N1aW5nLmFrbWRsLnVzLmFwcC5hei5rZXlmYWN0b3JzYWFzLmNvbS9lamJjYS9wdWJsaWN3ZWIvd2ViZGlzdC9jZXJ0ZGlzdD9jbWQ9Y3JsJmlzc3Vlcj1DTiUzREFsYXNrYStETVYrSUFDQSUyQ08lM0RBbGFza2ErRE1WJTJDU1QlM0RBSyUyQ0MlM0RVUzAdBgNVHQ4EFgQUnG/8jgGkyjyKsmmZHwRklS8YxNQwGgYDVR0QBBMwEYEPMjAzMzAyMTAyMzIyMzhaMA4GA1UdDwEB/wQEAwIBBjAKBggqhkjOPQQDAwNoADBlAjBo/GoIeq0E6ZJAxUtMfyj3IYsXu9Aucg28yTfDAR0J8sqH18j3H9YThID1rFWT3+ECMQDlUAUD4AOg8BdCV9MJoBEMQXXPwa/NxLpRSrpshflgNiPYiTEagDl2oH5AglotZmU=",
                "MIIDKTCCAtCgAwIBAgIKQhxPGaisOl0maDAKBggqhkjOPQQDAjBEMQswCQYDVQQGEwJBVTEkMCIGA1UEAwwbVHJhbnNwb3J0IGZvciBOU1cgU1RHIC0gSVQzMQ8wDQYDVQQIDAZBVS1OU1cwHhcNMjUwMTI3MjM1NjA3WhcNMzUwMTI4MDAwMDAwWjBEMQswCQYDVQQGEwJBVTEkMCIGA1UEAwwbVHJhbnNwb3J0IGZvciBOU1cgU1RHIC0gSVQzMQ8wDQYDVQQIDAZBVS1OU1cwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQzqzBqcbcM0hRqXL3Aj8TecHB2ThmNYpzyQRIKs0DVBSIRAPg4VJhKcoT4woA5mmnDjnQdNCvELUYmN2wEHx/to4IBqDCCAaQwHQYDVR0OBBYEFLduQe8uIic80uCCrJg9/FSGuTwIMA4GA1UdDwEB/wQEAwIBBjASBgNVHRMBAf8ECDAGAQH/AgEAMIGYBgNVHR8EgZAwgY0wgYqggYeggYSGgYFodHRwczovL3RyYW5zcG9ydG5zdy1pdDMucGxhdGZvcm0uc3RnLnZjZS50ZXN0c2VydmljZW5zdy5uZXQvdjIvY3JlZGVudGlhbHMvbW9iaWxlL2lhY2FzLzE2ODkyNGUzLTg0MDktNDI4ZS1iMmJkLTU5YWFlMjkyYjIzMi9jcmwwRwYDVR0SBEAwPoY8aHR0cHM6Ly90cmFuc3BvcnRuc3ctaXQzLnBsYXRmb3JtLnN0Zy52Y2UudGVzdHNlcnZpY2Vuc3cubmV0MHsGCSsGAQQBg+BqZARuDGxodHRwczovL3RyYW5zcG9ydG5zdy1pdDMucGxhdGZvcm0uc3RnLnZjZS50ZXN0c2VydmljZW5zdy5uZXQvdjIvY3JlZGVudGlhbHMvbW9iaWxlL3N0YXR1cy1saXN0cy9kaXN0cmlidXRpb24wCgYIKoZIzj0EAwIDRwAwRAIgGkNZUTYCJk1zPwRdAo35kKDbRZV2H3ghqp8jHev/I98CIAP04FsnYJClJDq2Wc8qK7aJIRmsqUqdI9az+k8n7wu3",
                "MIIDTzCCAvWgAwIBAgIKdxoV3oDLdOvqxTAKBggqhkjOPQQDAjBSMQswCQYDVQQGEwJBVTEyMDAGA1UEAwwpVHJhbnNwb3J0IGZvciBOZXcgU291dGggV2FsZXMgKG1ETCkgLSBJVDMxDzANBgNVBAgMBkFVLU5TVzAeFw0yNTA3MjMwNDIzMDlaFw0zNTA3MjMwMDAwMDBaMFIxCzAJBgNVBAYTAkFVMTIwMAYDVQQDDClUcmFuc3BvcnQgZm9yIE5ldyBTb3V0aCBXYWxlcyAobURMKSAtIElUMzEPMA0GA1UECAwGQVUtTlNXMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEdBacYce3Q8JBqV66qK38r5v2/ctpZyqvQ3V2PvdqHS10kiM8F4nUkKr2P0eH9WbleqVnw26oSd5nYtUb5/2yn6OCAbEwggGtMB0GA1UdDgQWBBQPz5dilBQ5Wb4acrU+glkaWyT2fDAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADCBmwYDVR0fBIGTMIGQMIGNoIGKoIGHhoGEaHR0cHM6Ly90cmFuc3BvcnRuc3ctZGwtaXQzLnBsYXRmb3JtLnN0Zy52Y2UudGVzdHNlcnZpY2Vuc3cubmV0L3YyL2NyZWRlbnRpYWxzL21vYmlsZS9pYWNhcy80ZGU5NGVlNi0wOTI0LTQxZjEtYjE4My00MzllMWQ2NGUyODcvY3JsMEoGA1UdEgRDMEGGP2h0dHBzOi8vdHJhbnNwb3J0bnN3LWRsLWl0My5wbGF0Zm9ybS5zdGcudmNlLnRlc3RzZXJ2aWNlbnN3Lm5ldDB+BgkrBgEEAYPgamQEcQxvaHR0cHM6Ly90cmFuc3BvcnRuc3ctZGwtaXQzLnBsYXRmb3JtLnN0Zy52Y2UudGVzdHNlcnZpY2Vuc3cubmV0L3YyL2NyZWRlbnRpYWxzL21vYmlsZS9zdGF0dXMtbGlzdHMvZGlzdHJpYnV0aW9uMAoGCCqGSM49BAMCA0gAMEUCIHFLMuQ3JWacAmzT2kuVMZaITtZNclKKsE9dog8OEI4pAiEA/yjIYKW1iZc4gbrcIvGCR41hWagsyBPSiJiYsGw0QPU=",
                "MIICgDCCAiagAwIBAgIJAdGsox/oZjHWMAoGCCqGSM49BAMCME8xCzAJBgNVBAYTAlVTMQwwCgYDVQQKDANISUQxDDAKBgNVBAsMA0NJRDEUMBIGA1UEAwwLZ29JRG1ETElBQ0ExDjAMBgNVBAgMBVVTLVRYMB4XDTI0MDczMTAwMDAwMFoXDTMzMDczMTIzNTk1OVowTzELMAkGA1UEBhMCVVMxDDAKBgNVBAoMA0hJRDEMMAoGA1UECwwDQ0lEMRQwEgYDVQQDDAtnb0lEbURMSUFDQTEOMAwGA1UECAwFVVMtVFgwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARUz2Hp/0f2P1IPWpP+2Ab4DBrdJVEXBeLi4P6ulmJ8dK2QfzRu3x1QaLTMYRjl61r4ljtnFgO2PgTsDlR8u8vFo4HqMIHnMBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBRG1Oiyl8yrfi/1pOcjSfcsfU1pFDArBgNVHRAEJDAigA8yMDI0MDczMTAwMDAwMFqBDzIwMjkwNzMxMjM1OTU5WjAkBgNVHRIEHTAbhhlodHRwOi8vd3d3LmhpZGdsb2JhbC5jb20vME8GA1UdHwRIMEYwRKBCoECGPmh0dHBzOi8vZGV2LWxzLmdvaWRodWIuaGlkY2xvdWQuY29tL2NpZC9oaWR0ZXN0aWFjYW1kbC5jcmwucGVtMAoGCCqGSM49BAMCA0gAMEUCIQDVnXuCCD76kdtfWbFck0Jxsv+at/99eDzegB6gWelLvQIgLFMtV5xyB1E9mM/nWTKzAlzrl2IBUPq4GqUW/E5GCAw=",
                "MIIC7jCCApWgAwIBAgIUAIlZVGm+MFztWeqnzmHC1Liq1DAwCgYIKoZIzj0EAwIwZjEOMAwGA1UECBMFVVMtTUQxCzAJBgNVBAYTAlVTMRQwEgYDVQQHEwtHbGVuIEJ1cm5pZTEVMBMGA1UEChMMTWFyeWxhbmQgTVZBMRowGAYDVQQDExFNRE9UIE1WQSBtREwgUm9vdDAeFw0yNTA2MTgwNjAwMDBaFw0zMDA2MTgwNjAwMDBaMGYxDjAMBgNVBAgTBVVTLU1EMQswCQYDVQQGEwJVUzEUMBIGA1UEBxMLR2xlbiBCdXJuaWUxFTATBgNVBAoTDE1hcnlsYW5kIE1WQTEaMBgGA1UEAxMRTURPVCBNVkEgbURMIFJvb3QwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATSFdDeo2zV3GjlWdICLEyVygkyiM3579U/WAtsibXSWXpXeAkENed6fs8a4lPCm3ScBa/GHQsc/xPWG5brrf/vo4IBHzCCARswDgYDVR0PAQH/BAQDAgEGMBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFLSwEXEzIOHS6lueN/d0ga94nZ3dMFUGA1UdEgROMEyBHG12YXByaXZhY3lAbWRvdC5tYXJ5bGFuZC5nb3aGLGh0dHBzOi8vbXltdmEubWFyeWxhbmQuZ292L2dvL3dlYi9Db250YWN0TVZBMG0GA1UdHwRmMGQwYqBgoF6GXGh0dHBzOi8vbXltdmEubWFyeWxhbmQuZ292OjU0NDMvTURQL1dlYlNlcnZpY2VzL0NSTC9tREwvNmVlMDdkMjE0MGYwNDJhMGE2ZTk5YTc4ZTQwNzlhYzAuY3JsMBAGCSsGAQQBg8UhAQQDTURQMAoGCCqGSM49BAMCA0cAMEQCIEOzO/2dCcx5yn8Hx6AdqCqgTNps18RrB0QGoHrwkFnxAiBApe5NXVdvg2yEhQylijYaUKTpJKNTiOx0CRPusfR5SQ==",
                "MIICWDCCAf+gAwIBAgIUSDXJYXPM1GzzndPu7U7uQQpoOU4wCgYIKoZIzj0EAwIwNTEWMBQGA1UEAwwNVkEgbUlEIElBQ0EtQTEOMAwGA1UECAwFVVMtVkExCzAJBgNVBAYTAlVTMB4XDTI1MDcyMjEzMjYwMloXDTI3MDcyMjEzMjYwMVowNTEWMBQGA1UEAwwNVkEgbUlEIElBQ0EtQTEOMAwGA1UECAwFVVMtVkExCzAJBgNVBAYTAlVTMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEZ96O6yAnVSQogBLxplgoWuEQbJGeNwkiC1Hx2MEKM6Jnpq4Wls+GU9IWImlUWWTaY0fgf+51Wkq1dguB8cVme6OB7DCB6TASBgNVHRMBAf8ECDAGAQH/AgEAMB8GA1UdIwQYMBaAFJYUvOtd2fu7Ag6feF/TB+YJ9+FNMCMGA1UdEgQcMBqGGGh0dHBzOi8vZG12LnZpcmdpbmlhLmdvdjAjBgNVHREEHDAahhhodHRwczovL2Rtdi52aXJnaW5pYS5nb3YwOQYDVR0fBDIwMDAuoCygKoYoaHR0cHM6Ly93d3cubW9iaWxlZGwubmV0L21vYmlsZUlEL1ZBLmNybDAdBgNVHQ4EFgQUlhS8613Z+7sCDp94X9MH5gn34U0wDgYDVR0PAQH/BAQDAgEGMAoGCCqGSM49BAMCA0cAMEQCIAZyBOjZrupvH9PqbgZNZFtgwVs+fXZVqgJKckP6FAbrAiAQdjxr6xA4VRVp/yjS9CKGoMw7tPkUrcfofZTv2AvPCA==",
                "MIICeDCCAh+gAwIBAgIQWluwShGaNXltKtR32ToazDAKBggqhkjOPQQDAjBIMRYwFAYDVQQDDA1JQUNBLVVUQUgtVVNBMREwDwYDVQQKDAhVdGFoIERMRDEOMAwGA1UECAwFVVMtVVQxCzAJBgNVBAYTAlVTMB4XDTIzMTIxODEyMjU0N1oXDTMyMTIxNTEyMjU0NlowSDEWMBQGA1UEAwwNSUFDQS1VVEFILVVTQTERMA8GA1UECgwIVXRhaCBETEQxDjAMBgNVBAgMBVVTLVVUMQswCQYDVQQGEwJVUzBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABGHwBQyjlOERffLUFurAF9F0gyRuD34FkPK8RfVuySJrooUnBi86jfKAEIFGzhAiR48EUe6YK2YcqfUqrEOX3uajgeowgecwEgYDVR0TAQH/BAgwBgEB/wIBADAfBgNVHSMEGDAWgBQ8TGzf54I0LuEU5s6tEgo5/Qg0azAnBgNVHRIEIDAehhxodHRwczovL21vYmlsZWRsLnVzL2lhY2EtdXQvMBEGA1UdIAQKMAgwBgYEVR0gADBFBgNVHR8EPjA8MDqgOKA2hjRodHRwOi8vd3d3Lm1vYmlsZWRsLnVzL3V0LWlhY2EvbWRsRFMtVVRBSC1VU0EwMDIuY3JsMB0GA1UdDgQWBBQ8TGzf54I0LuEU5s6tEgo5/Qg0azAOBgNVHQ8BAf8EBAMCAQYwCgYIKoZIzj0EAwIDRwAwRAIgdzrANru5rEm8T4qsYoPEo5YqJ6wyZstAfMfkp9/BtjcCIEez933eeyubFUfqjd3hXIoRcl1E0UTdnk/UOBLQCG10",
                "MIICjzCCAjSgAwIBAgIQLUkXR1dz1e3eU9H9y4KFbTAKBggqhkjOPQQDAjBFMQswCQYDVQQGEwJDWjETMBEGA1UECgwKVGhhbGVzIERJUzEhMB8GA1UEAwwYVGhhbGVzIEludGVyb3AgMjAyMiBJQUNBMB4XDTIzMTEyMzA5MDk0MloXDTMyMTEyMDA5MDk0MlowRTELMAkGA1UEBhMCQ1oxEzARBgNVBAoMClRoYWxlcyBESVMxITAfBgNVBAMMGFRoYWxlcyBJbnRlcm9wIDIwMjIgSUFDQTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABC+UWDQokxwBkHHN0Ga2HQBjZ1Hz/1hnH90idlDwQx1l2Pz/25ZMp/cWIrgIpIHh8yDtQZMQuRVOImeQn9GVE4ajggEEMIIBADASBgNVHRMBAf8ECDAGAQH/AgEAMDgGA1UdEgQxMC+BEmluZm9AbXVsdGljZXJ0LmNvbYYZaHR0cHM6Ly93d3cubXVsdGljZXJ0LmNvbTA4BgNVHREEMTAvgRJpbmZvQG11bHRpY2VydC5jb22GGWh0dHBzOi8vd3d3Lm11bHRpY2VydC5jb20wRwYDVR0fBEAwPjA8oDqgOIY2aHR0cDovL3BraS50ZXN0ZS5tdWx0aWNlcnQuY29tL2NybC9tZGxfaWFjYV90aGFsZXMuY3JsMB0GA1UdDgQWBBQ2kJJn/fLHhjDN93MKPpq5pabO8jAOBgNVHQ8BAf8EBAMCAQYwCgYIKoZIzj0EAwIDSQAwRgIhALt0IHkenB9TbjvucsgaUY+8PGOlO0fBV4bLzWMtsMq7AiEAjZFbcnEnIDYyGyFghdaPnbNadHmw4oo2nBhFoD7ERws=",
                "MIIDAjCCAomgAwIBAgIQMOSESVpEqPSkRUsPpJCrMDAKBggqhkjOPQQDAzCBgjELMAkGA1UEBhMCQVUxDzANBgNVBAgMBkFVLVFMRDEeMBwGA1UECgwVUXVlZW5zbGFuZCBHb3Zlcm5tZW50MQwwCgYDVQQFEwMwMDExNDAyBgNVBAMMK0lBQ0EgRGlnaXRhbCBMaWNlbmNlIFF1ZWVuc2xhbmQgLSBBdXN0cmFsaWEwHhcNMjIwNzIwMDQxNjEyWhcNMjkwMTE0MDQxNjEyWjCBgjELMAkGA1UEBhMCQVUxDzANBgNVBAgMBkFVLVFMRDEeMBwGA1UECgwVUXVlZW5zbGFuZCBHb3Zlcm5tZW50MQwwCgYDVQQFEwMwMDExNDAyBgNVBAMMK0lBQ0EgRGlnaXRhbCBMaWNlbmNlIFF1ZWVuc2xhbmQgLSBBdXN0cmFsaWEwdjAQBgcqhkjOPQIBBgUrgQQAIgNiAATjQ6ask4LE6nEFvxjMlsVgLUILECAWszfoFVPrXJ5b2rwASZEyw21zsT1UROOeB8Pb7NgUzO14dlmZ78nukWR6Ptw93ufZbmhx4hRSNXRBd/JQrqQJTWhAEzzSpb3LNs2jgcEwgb4wEgYDVR0TAQH/BAgwBgEB/wIBADA0BgNVHRIELTArgRBkbHBraUBxbGQuZ292LmF1hhdodHRwOi8vZGxwa2kucWxkLmdvdi5hdTBDBgNVHR8EPDA6MDigNqA0hjJodHRwOi8vZGxwa2kucWxkLmdvdi5hdS9jcmwvYXUtcWxkLWlhY2EtZGwtMDAxLmNybDAdBgNVHQ4EFgQUquYRfwpdHJFXNJ9rDXpriSuQrsswDgYDVR0PAQH/BAQDAgEGMAoGCCqGSM49BAMDA2cAMGQCMFZKYOGbR3Q9HdqMcmt0vevSWy/yWmUoI1d4eHUzhCAqJ0qtugb1DJcEEulqQEGb3QIwDBRJOfK1/iqz8AubOVuW9fjQPZlqvvqTnU0Hjiazf5JoSAB60yrfMyWNx+5EyEfp",
                "MIIDBjCCAqygAwIBAgIUfmdUTnwtHiMh2cmNKXzpaseaYCwwCgYIKoZIzj0EAwIwfzESMBAGA1UEAwwJTVZNVGVzdENBMS0wKwYDVQQKDCRBcml6b25hIERlcGFydG1lbnQgb2YgVHJhbnNwb3J0YXRpb24xCzAJBgNVBAsMAklUMQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVVMtQVoxEDAOBgNVBAcMB1Bob2VuaXgwHhcNMjQwNzMwMTY0ODA3WhcNMzQwNzMwMTY0ODA3WjB/MRIwEAYDVQQDDAlNVk1UZXN0Q0ExLTArBgNVBAoMJEFyaXpvbmEgRGVwYXJ0bWVudCBvZiBUcmFuc3BvcnRhdGlvbjELMAkGA1UECwwCSVQxCzAJBgNVBAYTAlVTMQ4wDAYDVQQIDAVVUy1BWjEQMA4GA1UEBwwHUGhvZW5peDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABNY+VmL4yYpiyjPqtf4MQuSljpcQi+B05sJ+rLicl+DcS3oQvQDl0k6eOAsyfBoIc8/mBxCy8TmR2TvD3fttHTyjggEEMIIBADAdBgNVHQ4EFgQUXF7M8VAMGOcshHf/si4EmqbxplUwHwYDVR0jBBgwFoAUXF7M8VAMGOcshHf/si4EmqbxplUwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAQYwLAYDVR0SBCUwI4YhaHR0cHM6Ly9hemRvdC5nb3YvbXZkL2NvbnRhY3QtbXZkMGwGA1UdHwRlMGMwYaBfoF2GW2h0dHBzOi8vbXZtcHVibGljLmJsb2IuY29yZS51c2dvdmNsb3VkYXBpLm5ldC9jZXJ0aWZpY2F0ZS1yZXZvY2F0aW9uLWxpc3QvTVZNUHJvZENBLmNybC5wZW0wCgYIKoZIzj0EAwIDSAAwRQIhAK267261uBPoHnM5o4DhCSsXbwP014nheQUjR0gBo39XAiAiNPoSJSxJJVuCnwNeCsm615YdjsNYgj5J141ucPbYfA==",
                "MIIDUzCCAvmgAwIBAgISESHtNjf+2KAQ0ttWtR9EhAAPMAoGCCqGSM49BAMCMIHFMQswCQYDVQQGEwJGUjEwMC4GA1UECgwnQWdlbmNlIE5hdGlvbmFsZSBkZXMgVGl0cmVzIFPDqWN1cmlzw6lzMRcwFQYDVQQLDA4wMDAyIDEzMDAwMzI2MjEmMCQGA1UECwwdUE9VUiBRVUFMSUZJQ0FUSU9OIFVOSVFVRU1FTlQxNzA1BgNVBAMMLkF1dG9yaXTDqSBkZSBDZXJ0aWZpY2F0aW9uIEZyYW5jZSBBdHRlc3RhdGlvbnMxCjAIBgNVBAUTATEwHhcNMjUwMTI5MDAwMDAwWhcNMzAwMTI5MDAwMDAwWjCBxTELMAkGA1UEBhMCRlIxMDAuBgNVBAoMJ0FnZW5jZSBOYXRpb25hbGUgZGVzIFRpdHJlcyBTw6ljdXJpc8OpczEXMBUGA1UECwwOMDAwMiAxMzAwMDMyNjIxJjAkBgNVBAsMHVBPVVIgUVVBTElGSUNBVElPTiBVTklRVUVNRU5UMTcwNQYDVQQDDC5BdXRvcml0w6kgZGUgQ2VydGlmaWNhdGlvbiBGcmFuY2UgQXR0ZXN0YXRpb25zMQowCAYDVQQFEwExMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEoCYCM9LYS8zUk8I1xL2B2G9voa4yFskoqohrsEQkpNEeKb59J3VDHausTqFWCOfwEGUzi6yocLIbE+gfz59pnaOBxjCBwzAOBgNVHQ8BAf8EBAMCAQYwMAYDVR0SBCkwJ4ElZnJhbmNlLWF0dGVzdGF0aW9uc0BpbnRlcmlldXIuZ291di5mcjASBgNVHRMBAf8ECDAGAQH/AgEAMEwGA1UdHwRFMEMwQaA/oD2GO2h0dHA6Ly9jcmwucXVhbGlmLmFudHMuZ291di5mci9hY19mcmFuY2VfYXR0ZXN0YXRpb25zXzEuY3JsMB0GA1UdDgQWBBR3bIy6PB3fPAlYHOvqk7nftps4sDAKBggqhkjOPQQDAgNIADBFAiBrI2HGG1SZNRfEoaIwk3bjAjLBcE9tcKPi1gu0oah58AIhAL+KWRF8FwT4JBblyZdmuoVVXJ36LMmAUcs5YwJpMiQW",
                "MIIDLTCCAtKgAwIBAgISESEFJUbpBJovlg7lg3Eb5YTCMAoGCCqGSM49BAMCMIGiMQswCQYDVQQGEwJGUjEwMC4GA1UECgwnQWdlbmNlIE5hdGlvbmFsZSBkZXMgVGl0cmVzIFPDqWN1cmlzw6lzMRcwFQYDVQQLDA4wMDAyIDEzMDAwMzI2MjE8MDoGA1UEAwwzQXV0b3JpdMOpIGRlIENlcnRpZmljYXRpb24gRnJhbmNlIEF0dGVzdGF0aW9ucyBJQUNBMQowCAYDVQQFEwExMB4XDTI1MTAxNzAwMDAwMFoXDTM0MTAxNzAwMDAwMFowgaIxCzAJBgNVBAYTAkZSMTAwLgYDVQQKDCdBZ2VuY2UgTmF0aW9uYWxlIGRlcyBUaXRyZXMgU8OpY3VyaXPDqXMxFzAVBgNVBAsMDjAwMDIgMTMwMDAzMjYyMTwwOgYDVQQDDDNBdXRvcml0w6kgZGUgQ2VydGlmaWNhdGlvbiBGcmFuY2UgQXR0ZXN0YXRpb25zIElBQ0ExCjAIBgNVBAUTATEwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASa4ZI0w4Mn4FW6kYdKPUlYYgVbwFf1A6lBDnurRsoPJxM3+dVupbkGl9O+QnJ36wc8ngoXE3oH1hP11flDmWsIo4HlMIHiMA4GA1UdDwEB/wQEAwIBBjASBgNVHRMBAf8ECDAGAQH/AgEAMDAGA1UdEgQpMCeBJWZyYW5jZS1hdHRlc3RhdGlvbnNAaW50ZXJpZXVyLmdvdXYuZnIwSgYDVR0fBEMwQTA/oD2gO4Y5aHR0cDovL2NybC5hbnRzLmdvdXYuZnIvYWNfZnJhbmNlX2F0dGVzdGF0aW9uc19pYWNhXzEuY3JsMB0GA1UdDgQWBBT/dscZoX+tou0+F2dDsFrTPfsMpzAfBgNVHSMEGDAWgBT/dscZoX+tou0+F2dDsFrTPfsMpzAKBggqhkjOPQQDAgNJADBGAiEAmMD8Kpgnctmx12gCBYrj98knoKDSPlO5SucThy1EEqwCIQDsYM80Ere4Yw0fHNJQQHl6D1rAITDV3qFKP62Uq7xtsQ==",
                "MIICezCCAiGgAwIBAgIJALgcge8tKGEoMAoGCCqGSM49BAMCMHYxCzAJBgNVBAYTAkpQMQ4wDAYDVQQIDAVKUC0xMzEVMBMGA1UEBwwMRGVmYXVsdCBDaXR5MR0wGwYDVQQKDBRGZWxpQ2EgTmV0d29ya3MsIEluYzEhMB8GA1UEAwwYRk4gVGVzdCBDZXJ0aWZpY2F0ZSBJQUNBMB4XDTI0MTAwNDAzMjk0MFoXDTM0MTAwMjAzMjk0MFowdjELMAkGA1UEBhMCSlAxDjAMBgNVBAgMBUpQLTEzMRUwEwYDVQQHDAxEZWZhdWx0IENpdHkxHTAbBgNVBAoMFEZlbGlDYSBOZXR3b3JrcywgSW5jMSEwHwYDVQQDDBhGTiBUZXN0IENlcnRpZmljYXRlIElBQ0EwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASAI1sg71rBcvxHoiv2kbzfrLUPfBvZCHKJHcbrEabjWgRdGD4DrFhBGr1U1VnwhD98vIot4VbU4qwrWfKrCuyao4GXMIGUMBIGA1UdEwEB/wQIMAYBAf8CAQAwHQYDVR0OBBYEFNmFci+h/djKirwFB9WWPUsQyOoWMA4GA1UdDwEB/wQEAwIBBjAnBgNVHRIEIDAegRxleGFtcGxlQGZlbGljYW5ldHdvcmtzLmNvLmpwMCYGA1UdHwQfMB0wG6AZoBeGFWh0dHA6Ly9ub21lYW4vdGhpL3VybDAKBggqhkjOPQQDAgNIADBFAiAppXqiNYULtAnHGVZ4YaNVYNKb0iRXENhAUUe7YxQdUAIhAMb22BkphGVDvsY2ov7wlzTsTQuHoCnwfjAtqtftp8Vj",
                "MIIDHTCCAsSgAwIBAgISESEhmoph1P1OOjDCLJAgGdBbMAoGCCqGSM49BAMCMIGfMQswCQYDVQQGEwJGUjEwMC4GA1UECgwnQWdlbmNlIE5hdGlvbmFsZSBkZXMgVGl0cmVzIFPDqWN1cmlzw6lzMRcwFQYDVQQLDA4wMDAyIDEzMDAwMzI2MjE5MDcGA1UEAwwwQXV0b3JpdMOpIGRlIENlcnRpZmljYXRpb24gRnJhbmNlIElkZW50aXTDqSBJQUNBMQowCAYDVQQFEwExMB4XDTI1MTAxNzAwMDAwMFoXDTM0MTAxNzAwMDAwMFowgZ8xCzAJBgNVBAYTAkZSMTAwLgYDVQQKDCdBZ2VuY2UgTmF0aW9uYWxlIGRlcyBUaXRyZXMgU8OpY3VyaXPDqXMxFzAVBgNVBAsMDjAwMDIgMTMwMDAzMjYyMTkwNwYDVQQDDDBBdXRvcml0w6kgZGUgQ2VydGlmaWNhdGlvbiBGcmFuY2UgSWRlbnRpdMOpIElBQ0ExCjAIBgNVBAUTATEwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQqfRW/7OTJS4K0IPMa/c8UicIUq62jTccQtGnHAYk6UnvXyRO3PC4/2pdq5QjhwIKwJVqCFOr4fbGboMKLX+L/o4HdMIHaMA4GA1UdDwEB/wQEAwIBBjASBgNVHRMBAf8ECDAGAQH/AgEAMCwGA1UdEgQlMCOBIWZyYW5jZS1pZGVudGl0ZUBpbnRlcmlldXIuZ291di5mcjBGBgNVHR8EPzA9MDugOaA3hjVodHRwOi8vY3JsLmFudHMuZ291di5mci9hY19mcmFuY2VfaWRlbnRpdGVfaWFjYV8xLmNybDAdBgNVHQ4EFgQUAQ1+Rjq9mU0kAyKKyTwFdgjmwA4wHwYDVR0jBBgwFoAUAQ1+Rjq9mU0kAyKKyTwFdgjmwA4wCgYIKoZIzj0EAwIDRwAwRAIgSNKCT8z4zaZLfdOd/rHevKYDbvjqylK723wjd4g4s0ECIDnoWVWyJHwlO31z3QmK7QapM00sOCJnsTIvEGi1Fz/I"
            ]
        """.trimIndent()
        )

    }

    @Test
    fun `must be able to decode and validate all qualified Austroads IACA certificate entries`() = runTest {
        iacaPemEncodedCertificates.map { pemEncodedCertificate ->
            JWKKey.convertDERorPEMtoByteArray(pemEncodedCertificate)
        }.forEach { derEncodedCertificate ->
            val iacaDecodedCertificate = iacaParser.parse(
                certificate = CertificateDer(
                    bytes = derEncodedCertificate.toByteString(),
                ),
            )

            validator.validate(iacaDecodedCertificate)
        }
    }

    @Test
    fun `must be able to decode but validation will fail because KeyUsage extension marked as non-critical`() =
        runTest {
            listOf(
                //Development ThalesCA Digital Licence Queensland - Australia
                """
                    MIIDLjCCArSgAwIBAgIUAMGWyWJ0XiYlailF8ayfaZQUcBIwCgYIKoZIzj0EAwMw
                    gZIxCzAJBgNVBAYTAkFVMQ8wDQYDVQQIDAZBVS1RTEQxHjAcBgNVBAoMFVF1ZWVu
                    c2xhbmQgR292ZXJubWVudDEMMAoGA1UEBRMDMDAxMUQwQgYDVQQDDDtEZXZlbG9w
                    bWVudCBUaGFsZXNDQSBEaWdpdGFsIExpY2VuY2UgUXVlZW5zbGFuZCAtIEF1c3Ry
                    YWxpYTAeFw0yNTA3MTcwMTIyNThaFw0zNTA3MTUwMTIyNThaMIGSMQswCQYDVQQG
                    EwJBVTEPMA0GA1UECAwGQVUtUUxEMR4wHAYDVQQKDBVRdWVlbnNsYW5kIEdvdmVy
                    bm1lbnQxDDAKBgNVBAUTAzAwMTFEMEIGA1UEAww7RGV2ZWxvcG1lbnQgVGhhbGVz
                    Q0EgRGlnaXRhbCBMaWNlbmNlIFF1ZWVuc2xhbmQgLSBBdXN0cmFsaWEwdjAQBgcq
                    hkjOPQIBBgUrgQQAIgNiAAQY7eWbi44OODcrRAVR2oLI4vTUHozuq+qzwgvrUDMa
                    /v9jVhSZG6buwiYlSmPo4vIu9S3KBWfWMQBSpm8BeX0XLA8J28LjA29TEvi4IbJh
                    u+O8MZxKgVMR6qFSoDvUVUijgcgwgcUwHQYDVR0OBBYEFN5miz54XUikMVOgLlbC
                    KfA9WcRkMBIGA1UdEwEB/wQIMAYBAf8CAQAwCwYDVR0PBAQDAgEGMDQGA1UdEgQt
                    MCuBEGRscGtpQHFsZC5nb3YuYXWGF2h0dHA6Ly9kbHBraS5xbGQuZ292LmF1ME0G
                    A1UdHwRGMEQwQqBAoD6GPGh0dHA6Ly90ZXN0LmRscGtpLnFsZC5nb3YuYXUvY3Js
                    L3Rlc3QtYXUtcWxkLWlhY2EtZGwtMDAxLmNybDAKBggqhkjOPQQDAwNoADBlAjBD
                    hWcGVlhAj6LE4pTrKJnkdWslX9Djic1Z1W2/KN7oUcnzpQjzxZvhEuqrbA/JbUsC
                    MQDhZyd2llRipxu1mIVIyflKBzy1a5uymgyGNwxQ4gAUJtTTaZ3oUNrlIVcTmTSq
                    yOg=
                """.trimIndent(),
                //Oneproof IACA TEST
                """
                    MIICJzCCAc2gAwIBAgIUE/qk/YIW/LUBva09BUFhZAImTykwCgYIKoZIzj0EAwIw
                    TTELMAkGA1UEBhMCVVMxDjAMBgNVBAgMBVVTLU9SMREwDwYDVQQKDAhPbmVwcm9v
                    ZjEbMBkGA1UEAwwST25lcHJvb2YgSUFDQSBURVNUMB4XDTIzMDgxMTIwNTkwM1oX
                    DTMzMDgwODIwNTkwM1owTTELMAkGA1UEBhMCVVMxDjAMBgNVBAgMBVVTLU9SMREw
                    DwYDVQQKDAhPbmVwcm9vZjEbMBkGA1UEAwwST25lcHJvb2YgSUFDQSBURVNUMFkw
                    EwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqcK2woK7G2H89SDnBE+Yxs5AIuWBvgrp
                    fjFtHF44t0jPlZNtJIkAy6z/I0Qu3vLulILVVhsjO0/kUTlujkOORKOBijCBhzAL
                    BgNVHQ8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADAbBgNVHRIEFDASgRBpbmZv
                    QG9uZXByb29mLmNvMB0GA1UdDgQWBBSX1zwDP7x0YBgqEpsA7CGqKWbKvDAoBgNV
                    HR8EITAfMB2gG6AZhhdodHRwczovL2V4YW1wbGUuY29tL2NybDAKBggqhkjOPQQD
                    AgNIADBFAiBM/hKnF0Ch+hLtYxwDgVbf5s6n10//n3rc9NFbf8NZEgIhANmCmsF8
                    7ZFYovtxhTXNsvAjA10mNkWofo2DEL2jxtlr
                """.trimIndent(),
            ).forEach {

                val iacaDecodedCertificate = iacaParser.parse(
                    certificate = CertificateDer(
                        bytes = Base64.Mime.decode(it).toByteString(),
                    ),
                )

                assertFails {
                    validator.validate(iacaDecodedCertificate)
                }

                //turn off critical extension validation
                val modifiedValidator = IACAValidator(
                    config = IACAValidationConfig(
                        requiredCriticalExtensionOIDs = false,
                    )
                )

                //this should not throw now
                modifiedValidator.validate(iacaDecodedCertificate)

            }
        }

    @Test
    fun `must be able to decode but validation will fail because 'ZZ' is not a valid ISO country code`() = runTest {
        /*
            Table B.1 - "IACA root certificate" of Section B.1.2 - "IACA root certificate" of Annex B - "Certificate and
            CRL profiles" of ISO/IEC 18013-5 states the following regarding the certificate issuer's X500 name:

            countryName is mandatory. The value shall be in upper case and
            contain the ISO 3166-1 alpha-2 code of the issuing country, exactly
            the same value as in the issuing country data element. The
            countryName shall be PrintableString.

            In our code, countryName == country.

            However, there exists an IACA certificate entry in this VICAL that has a countryName of "ZZ". This is
            not a valid country code, it is part of a country code set that "can be user-assigned".

            So, ISO 3166-1 says it's not a valid country code, which is also what the JVM's Locale class says.

            However, various VICAL-parsing resources, will happily parse it and not throw an error :man-shrugging:

            * */
        listOf(
            //OWF Identity Credential TEST IACA
            """
                MIIChzCCAg2gAwIBAgIBATAKBggqhkjOPQQDAzA5MSowKAYDVQQDDCFPV0YgSWRl
                bnRpdHkgQ3JlZGVudGlhbCBURVNUIElBQ0ExCzAJBgNVBAYMAlpaMB4XDTI0MTIw
                MTAwMDAwMFoXDTM0MTIwMTAwMDAwMFowOTEqMCgGA1UEAwwhT1dGIElkZW50aXR5
                IENyZWRlbnRpYWwgVEVTVCBJQUNBMQswCQYDVQQGDAJaWjB2MBAGByqGSM49AgEG
                BSuBBAAiA2IABPkA8nu9JtjtJZT1zI1Y8VWc95uZOmoE/sIofi+/W+48qlJffbG3
                lJ6cWiw/nJgdxyt7cJAO35lSUqGwXPvQg4ZId5sep/mKB+UbpWklk4VgXzMkY7H1
                Tg5KLBywg52z1aOB6DCB5TAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB
                /wIBADBMBgNVHRIERTBDhkFodHRwczovL2dpdGh1Yi5jb20vb3BlbndhbGxldC1m
                b3VuZGF0aW9uLWxhYnMvaWRlbnRpdHktY3JlZGVudGlhbDBSBgNVHR8ESzBJMEeg
                RaBDhkFodHRwczovL2dpdGh1Yi5jb20vb3BlbndhbGxldC1mb3VuZGF0aW9uLWxh
                YnMvaWRlbnRpdHktY3JlZGVudGlhbDAdBgNVHQ4EFgQUq2Ub4FbCkFPx3X9s5Ie+
                aN5gyfUwCgYIKoZIzj0EAwMDaAAwZQIxAJJDZ5Js5BdvcpxcaTW8nqHDMsvyEPFS
                aM2AvfF4YHUmlNiAibbJpbw5QoVoaAV5ugIwbycvXRI6z6m2pxlC0y/Dp0MI+87J
                HFMK+WcuHCgIGPfHBqR4T1XMMqyFeFrO4AKA
            """.trimIndent(),
            //Payground Root
            """
                MIIC/jCCAmCgAwIBAgIJAI2FjRUdyT0BMAoGCCqGSM49BAMEMDcxCzAJBgNVBAYT
                AlpaMQ8wDQYDVQQKDAZHb29nbGUxFzAVBgNVBAMMDlBheWdyb3VuZCBSb290MB4X
                DTI1MDQyODA0MDcxMFoXDTM1MDQyNjA0MDcxMFowNzELMAkGA1UEBhMCWloxDzAN
                BgNVBAoMBkdvb2dsZTEXMBUGA1UEAwwOUGF5Z3JvdW5kIFJvb3QwgZswEAYHKoZI
                zj0CAQYFK4EEACMDgYYABAEjCus99ox1/datgRORqDvJq34+Xm1keediDUXacFW+
                RzMFOu4sK1yDDliqWtXThHi8jTUVsoYohzxCmPbOumFTvAArCpNF5BoYFRtDTcME
                KZ0ZZ5NM8OLDO+FMrWZq6GJoDbA+HkDkgdIX3/Xrh52CZRc1ulOlWjzwtu1eSFLf
                XfVlY6OCARAwggEMMB0GA1UdDgQWBBRzpwQeUIGTnuDbtwKK43Ev0Ko2wTAfBgNV
                HSMEGDAWgBRzpwQeUIGTnuDbtwKK43Ev0Ko2wTASBgNVHRMBAf8ECDAGAQH/AgEA
                MA4GA1UdDwEB/wQEAwIBBjAhBgNVHRIEGjAYhhZodHRwczovL3d3dy5nb29nbGUu
                Y29tMIGCBgNVHR8EezB5MHegdaBzhnFodHRwOi8vcHJpdmF0ZWNhLWNvbnRlbnQt
                NjYwM2M2NDctMDAwMC0yOWQ0LWFlYTYtZjRmNWU4MGQxYjkwLnN0b3JhZ2UuZ29v
                Z2xlYXBpcy5jb20vNDFkNDM2ODU5ZTQ1ZGJmM2U1YTkvY3JsLmNybDAKBggqhkjO
                PQQDBAOBiwAwgYcCQgH+co3yU5I2KQyAP8Rf85onNd65dzjBna6nvd7HAMFxcPSG
                7xMu+drc8uVSmi0SYAw4M0fo0YTxphg/xDuc5ekGTQJBcqy8C/+CBBVt4YsJWLgV
                5rSqIf7u7i69b2s2NHL8nypSqTn9pQRlQjs7qLgZyM1LjKbCPaCU8OrsLiNoCOxM
                Xvc=
            """.trimIndent()
        ).forEach {

            val iacaDecodedCertificate = iacaParser.parse(
                certificate = CertificateDer(
                    bytes = Base64.Mime.decode(it).toByteString(),
                ),
            )

            assertFails {
                validator.validate(iacaDecodedCertificate)
            }

            //turn off principal name validation
            //and serialNo because both are violated
            val modifiedValidator = IACAValidator(
                config = IACAValidationConfig(
                    principalName = false,
                    serialNo = false,
                )
            )

            //this should not throw now
            modifiedValidator.validate(iacaDecodedCertificate)

        }
    }
}
