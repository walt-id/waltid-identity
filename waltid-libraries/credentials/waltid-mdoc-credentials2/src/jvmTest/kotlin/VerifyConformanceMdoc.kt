import id.walt.crypto.keys.jwk.JWKKey
import id.walt.mdoc.crypto.MdocCrypto
import id.walt.mdoc.crypto.MdocCryptoHelper
import id.walt.mdoc.parser.MdocParser
import id.walt.mdoc.verification.MdocVerificationContext
import id.walt.mdoc.verification.MdocVerifier
import kotlinx.coroutines.test.runTest
import kotlin.test.Test
import kotlin.test.assertTrue

class VerifyConformanceMdoc {

    companion object {
        private const val vpTokenMdocBase64 =
            "o2d2ZXJzaW9uYzEuMGlkb2N1bWVudHOBo2dkb2NUeXBldW9yZy5pc28uMTgwMTMuNS4xLm1ETGxpc3N1ZXJTaWduZWSiam5hbWVTcGFjZXOicW9yZy5pc28uMTgwMTMuNS4xmCjYGFhZpGhkaWdlc3RJRA9mcmFuZG9tUDr8IApyTHx9DTHlcZQRlb1xZWxlbWVudElkZW50aWZpZXJrZmFtaWx5X25hbWVsZWxlbWVudFZhbHVlak11c3Rlcm1hbm7YGFhTpGhkaWdlc3RJRAJmcmFuZG9tUF9SoLqlwhGNtrI5GA9b6RdxZWxlbWVudElkZW50aWZpZXJqZ2l2ZW5fbmFtZWxlbGVtZW50VmFsdWVlRXJpa2HYGFhbpGhkaWdlc3RJRAZmcmFuZG9tUPiqFNPzWq9YKsZ5wWxQIjpxZWxlbWVudElkZW50aWZpZXJqYmlydGhfZGF0ZWxlbGVtZW50VmFsdWXZA-xqMTk3MS0wOS0wMdgYWFukaGRpZ2VzdElEEWZyYW5kb21Q_V9szcd8cksJusok8WqM8HFlbGVtZW50SWRlbnRpZmllcmppc3N1ZV9kYXRlbGVsZW1lbnRWYWx1ZdkD7GoyMDI0LTAzLTE12BhYXKRoZGlnZXN0SUQWZnJhbmRvbVBp9ETPd5JeHfbtL-Z_awKfcWVsZW1lbnRJZGVudGlmaWVya2V4cGlyeV9kYXRlbGVsZW1lbnRWYWx1ZdkD7GoyMDI4LTA5LTAx2BhYVqRoZGlnZXN0SUQYGGZyYW5kb21QnfzkRVo8g8wkkgAo3ra-GnFlbGVtZW50SWRlbnRpZmllcm9pc3N1aW5nX2NvdW50cnlsZWxlbWVudFZhbHVlYlVT2BhYeqRoZGlnZXN0SUQYH2ZyYW5kb21QHTNwKIoGZpaaZVYmUJgox3FlbGVtZW50SWRlbnRpZmllcnFpc3N1aW5nX2F1dGhvcml0eWxlbGVtZW50VmFsdWV4I1V0b3BpYSBEZXBhcnRtZW50IG9mIE1vdG9yIFZlaGljbGVz2BhYXKRoZGlnZXN0SUQEZnJhbmRvbVClaRZnu7NndoUkNIRzRWG5cWVsZW1lbnRJZGVudGlmaWVyb2RvY3VtZW50X251bWJlcmxlbGVtZW50VmFsdWVpOTg3NjU0MzIx2BhZFRWkaGRpZ2VzdElEGC1mcmFuZG9tUEdm_l8N2-DIJj-0GcJZvKhxZWxlbWVudElkZW50aWZpZXJocG9ydHJhaXRsZWxlbWVudFZhbHVlWRTG_9j_4QDKRXhpZgAATU0AKgAAAAgABgESAAMAAAABAAEAAAEaAAUAAAABAAAAVgEbAAUAAAABAAAAXgEoAAMAAAABAAIAAAITAAMAAAABAAEAAIdpAAQAAAABAAAAZgAAAAAAAABIAAAAAQAAAEgAAAABAAeQAAAHAAAABDAyMjGRAQAHAAAABAECAwCgAAAHAAAABDAxMDCgAQADAAAAAQABAACgAgAEAAAAAQAAAHigAwAEAAAAAQAAAJmkBgADAAAAAQAAAAAAAAAAAAD_2wCEAAQEBAQEBAcEBAcJBwcHCQ0JCQkJDRANDQ0NDRATEBAQEBAQExMTExMTExMXFxcXFxcbGxsbGx8fHx8fHx8fHx8BBQUFCAcIDQcHDSAWEhYgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIP_dAAQACP_AABEIAJkAeAMBIgACEQEDEQH_xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29_j5-gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4-Tl5ufo6ery8_T19vf4-fr_2gAMAwEAAhEDEQA_APouZf3r8_xGosgjFSSf6x_940yus84YvI5pjccA0uQoyccVyvizxHD4c06S6lbDgcZ65_pWVWsqcbs2oUJVXyoq-KvGWl-F7dmuZA854SNT8xP-FfLviHxr4i1-RmA-zwj7qr6erHtTtQke53eIvELEBz-5RurZ7BfX-VZIt7u7YS3ceO8FonQD-_Ie_wCNef8AE-ef_APXVP2ceSGhj-ZuHmXT5z35yf606a_tY0KqspDDHzHt-NT6kbfTFJcb7jbuYfwoPf6-lcsgnmzNIM56sewreCvqYyfL7pZsZYYZCvVWOVB-Xg9efpXZ2aOIxJZPGSOOx_CvO2mUEbQCvQEVrLqF5YquNpiYDaWUEfn1qpwbFTmket6TqswcQaxGCn99RwB7iutm01Y0-26cwkUAfdHb-leNadr8_mKkkMQJ-6A2Ff2BYkKfxx24r03QLjePtmnsy4-V4XG0qe4I7VxzTidcHzaHeaH4jMSo34Nn-Veo280NzGs0DB1YcV5CunQakDcWy7Jf41HANdB4evZdLnNhe8wyn5G_ut7_AF6Vthq_I7PY5cZheePNHdHoWc0cU9SSMHtS_N6GvWPDsf_Q-jJHXzG9Mmq7MynIHWppTtkb6mrVnb7ybqXG1BkGuidRQV2cVOk5tRRRuXi0yzN9e43f8s0x-VfPfiGN9e1OW91XP2Kx-eTP3S_VU_DvXruu3M1_N5yDdhhHEn95zwPwrjPEOly3UsHh22AMMPz3Ln-N-prwJ1nOXMz6mhhFSgoI8Mkik1q7bXL9f3KfLbQnsvbA9-K3ItPa2tG1Kdd0khxEn99z93P-yPyr0I-Ho2uFVgPLT73-FUNasGvdtnGuA4KAf3U9fYtQ6vQ1WGPCYdGudc1AxwZlRn-aTH3vVz7cfKPTHrWZ4jSKGcaVYDMUXEjjHzv3_AdK9_vtPXw_oxsbMbLm6XAYdUXvj07Y_CvPoPDQWBpxHlHOAPZa6Y4lJ-hyPBtqyPKbHT_tNvIzKRj5gO-Bx_hXRaVpr-QtndLvilzsPfftyMfUDGPpXpun-GY7eKMLwGZP--S3P6U5NEeOwSQjmORT-TYz-VOeKvsEMC42PJxpxtJDbuN2BwMfK69vx9a7jw6JbG4jmi5hYbQSeV_2T6r_ACrq9Q0UuiPt7bsY_A_596NO0zY23n1_Csp1-ZFxwvKzubZvLH2yIZK8SIPT_Gt94oL6ITJgk9D2PtWNY4h2MTwPlYDuOx_LirMYl0y98oHEMvK56D2_Cs4vqVKPQ7TS7gyWyxyE7k-XFamV9f0rlomlSTzk4PQ46FaufbH9B-Zr1KOKSikzxa-AbneB_9H6OKbrggDuavXzkW62cXC4yxpsCt5jtx1xn_Cq123lQlz2P61x46rf3UdeWUftmbpdms2pSTcf6MuF9Azf_Wp1ppCGB7zqZXKpn2POPStnw_b-XpzuRlpXY_ieBW7FHDFE-4_u7aMRL7kck1wxjoes6lmeWX2nrbhl6etYlvp6fPqFx9xQP_rCu4vkfUboW8C_e_z-lY3iFYY_9FXCW1uN0re4HA_pWL01O-OyieZ6pFJdziR_vSnaq-iitLUNJgsLNLZQPlXH1LVa8MW76_r5nK4htl3D6Cujntl1HxAqsD5MH7xz268ChLQu1pcvZGLJoqRywWyckNGnPrwKSXQoxpMg248sOPwQjFb-r3kFrfwLnnzBIcdhnI_StScIfDNzNzlmc_gzD_CtF1Ri9FFnAw2EdxpsD4yVO1vxH_6qoiw8qUbR0AOP51paTc4iktycLvAGfdcf0FaDfvhDJjBw0Z-o5oJktTFuLdrWAsOdgK_h1qzcRm-0pCPvoAyketas1uJrA7QOmR-WKr6KA1kocY_oM4rSJyzRS0y6324Y_wAPBHof8K0_tfutZaxC01J4gcK3IFau9f8AOKtO2hztH__S-o0jPmFF4wWNc9rU5iRVHUnIFdYi8vjHOen1rz7xDOTqQgQ_dAQY9Wrx8Qz28HFJHodiDFYwHjIGf0_xrntU1WFY0tSdqk7j6n1rpZWSLTFwcYTAb2xivMb-6tLSzbVtQXdljgegBwqgfQVFRrY68LT5veN7SrpY7SXUZQI2l_1YbsucDPoSf0ryXX_E1vrN02n6dvMMbnc-OHYcbvf2HpUXiTxP4ikgS6s7BIbV2_dfapNrSsBydi_dVQOprJ8OeI2vGD3FnbmIrvSa0O-NwDtJB7_NxRKjJLWOhdCvTdS3Nqes-EoY9M0ieYjDP0_LiodNmjfMC7d85wTn0yMVpWwgurIQw_dI4x0NZTaWLCT90Ru61l2O9QT5r7mVrqebqz3AwUDlEx2VMAVsyaraNok1pI_R-R6fNXIavepDMEmySTz6VlyeJtDtbeVZBvCkbyBx79KunqzGtGMYxTexlzX1vaFxFIMbgy4_EY_GuvsLtLiFXzn5w4I9xg_rXna-J_Bs05tZLR7Z24zIuzP51fWb-xB9sspPMsmPzIOWU-39RROPKZqSqL3Wek2EpeCSB_4cjFQaKygGLIO1wuOn3v8AIqTTDG881xEcpJ5ci47hl5_lVbRRvu7xB_C24fg39KqDOSoiXVYPKu45e_Q_yqHePSt3X4sDdtyP_wBRrktyf3RWkjGL0P_T-rLqT7OjsODub9K8s1ObOrCcHIMikfgo_rXo2vY8lynGM_nXmGoqfLEg4KqT9PT-VeBiJH0mDhoej6rdiLRYQuSzJGB9T1_lXKPZfabeOG8QOIySvtmt7UmaWKy5yvlRn_x2qEscjDehxQ_iud-GilBHEaz4a1UWYi065_dkuFEq79okBV1BH8DjqD07VwyaNfaPp8lgBCg8swoFTy40QncdiDpluTXrk91Oo2nbxWD9njvJh5_z88AVr9YlsH1GlfmcdSz4Okvhp8AvmEkgHzPjG7AwGx2yOtTatfsbsoPp-FdBb28drDvIxt7VyGp-W1wJR3PPFYSOmmluc5rUEc6M7Kx2jIxx-FeSrLdQC5iiiQiR1MatzgLnjj8_rivdvIjl-VuQa4e90eCO4Z7b5cGt6dXlOWthlUVnscN4e0e8-0gXdu08Ucs0ubpg2_zV27C3P7sf3cV0UWg3en6e7xHfH0eIdMdsHqcdB7V1NlmNNqkk_SuhtflQhxwfaqq1-dWMsNgY0XeJj-C71Z7AwH78cSpz1wrED9DWxou6DXLmPGBIG5-p6flisG1Eem67IsX3J4_l-ua6HS3xrrNnGc9vasKLIxVPlOs10GSz3ei_yrg9yeld9qYJtZU45UVxX2Y11NdjhgrI_9T6j1BBNC8eOUk5rz7VohHZSZ9Qv4ZrvXLreTbvuk4A_GuJ8R4W0-X--BgV89X1PqMJpZG08ytY2D8fdCf4UrRO446dK5qW6CaKIc_NDtl_AnNdL9o2kccEA_nQnq0dlL4VY5nUYpY87a5_RLif-02hdeh4r0G9-zyw-YcdcCq9rpMEWZTgMe_pS5feOpVVyaouyROJHR5VztGIgRkfhXO31qqj5xgGq-teGNK1S7S_u2ZbiLBSWMlWGPcUmuP9ptxFFKQAAN3em0KnpazMyJTvyh-QYrlNXJN4QoA9AKvaXolto_mm1ldvNbc5kYsT-dTyRW5vPNYjBpTVlcum1ezItMgYoCRWncfImKsq0ESDaeKyrm4SQ4Bzip5tDTl10Oc1O4SG6trluCJNg_GupsSx1cEd8dK8y8Zz7JtPgXjMobj6gV6Pocvn39sB_FtNXRjZJnmY2SlJpdD0LV9iIU7hgp_AVzm6P0rS1e53ymP_AGi1Yu8e36V13PMSP__V-n9QAFyyL_Ex_LNcRrmJZoLePGZeeeMDoP0rtL5S927J_eKD6ZrzHX7yO3uLi_flYV2Rj3xivn6259PhvhRzV7rMUeuNppbHmwlc9v3S_LXqWjzpqOl29zGfvRr_AIf0r5X1u6afbeCQx3EZbn2PUV7H8GfEH9p6HNp07Zkspig_3G-Zf8KzpxbjdnXKSjLlXyO-v4p4biJwnmBVJVc4GazJPEFpbnF2rwMeCGGQPx6V2NwgcDP8NY11p0V2CHXNXy9jenOL-M5ifWNOlyUuFK46iubuNesh8kkyfhR4h8KQmPzYR5cqnkpxn6ivP20ba7b1yTxu_wAKnra56caFOVPmizsU1vTwSPPQegNQyanpchEPmo2_gBa5iDw_bySD92AB3Izmuut9Os4IfLiRVx7Vo0rbnDKKjoitbTXCNJbSEsq7Sj_7J7H3FTRhmcnPAqeGMx5TualaPYPrXO0XF6Hl_jmfy9VssdV5_WvT_DUmyWK4b-Bf_rV4b4t1JJ_GIthytskZb6lhx_Ova9NgltleOTjZxn2NdihaETxqk1KpM3bi682RGPG5TVfK-9VryIwxwyoPujP61W-2v6fyovYxsf_W-pLwrBbyzL95dyp_vscV4F4wlyhso-QGGT6kmvfNTjHkEHoCxr5_1iI3Fyz-rg_gK-exHxWPqMJ8NzzHV7fah_E_nx_SrXwxvLjR_FCbOY7r91IO3JypH0xWxq1sdjbRz0p-haWbe-S66FSNo98iiM_daNPZ-8mfTJIYbuxqsSY1OamWPzYRPCcEgHFVTdRYIPUUzdLsYOokuvHSuUuE2vlVUj_drrruYMh2gYrm7gYG4qBioaVzugny7GU6rn5U571Crc9Oac90gJGOlUZbuFORxQ5LZEcheHH7zvWFrurxaZZtcHl8YRfUnpVpJpLt_Lg4Hqa4Xx2oijSIHnvUwjeSRNWXJB2PEzNJc3N9eSkmR3DZ_wB09K-vtLZbywhuOv2i3WT81H9a-SbHYc8ehx9P_rV9aeF7VoNH0qN-gto1YHtvXoffivVxGlrHzeF1uaNwN9l5B6xIvPsRmue8v_aH6V2F5CttdIkudsuI_wAO39Kl_syz_vD9K5kzqaP_1_qDXmAt2_3iBXj1zbjezkcCvVNcOdsf_TRq417AzMUxwTXz1bWR9XhV7iOEvtPbYCR7_jXn_wDabx-I7SLdwsqr7HsQRX0Tf6dEZFiRRwM_jXz1478Nah4f1S312FC1sZQXbB-Q9s_U4rSFK5tKVo3R9QaVKTDgnsP5VHcWaTk9j7VxnhPxNp9_aJslG7gH69671ZFkztxxWa1VjR3i7oxbfRYwj78n8a57UdL6oGIFd680ew9iK5XUpFVTyKUkktDajOTepwF7Yp5JYMd6_KcdxWDHA7HGK6iaRGYjr7VB5I6gDNZpG7EsoxBHXlHjt3ZmP1xXsaxlY8ngCvH_AByJbm5i0vTE826nYxxovXJXr7YrajH34o5MU_3cjl_BVlb3d15ZiUxQDzJWYZPy9hX0_YW-zRbaROMgD_vk1594f8HxeG9G-zSmOSZolSTaT1YgHFen3c0NqsdmvCRhY8fQcn866q8tTz6VLkikV9Y23Noj_wAXB_EcGuW2P_tVq2l2XuzpspysiMB_vDt-Iq__AGV_sN-VRYz0Wh__0PoOWQXDlC2Srkj8yKuG1Hykkcdf61eg_wBef97-prfl-5-FeKqZ9Iq1rJIwre3i-1jONzgBavahoVpeW8kUihkddrg8gg9RitNP-PyL610B-631rspU1YwqYlpxsfIPiL4V6hpMxvvCTMqA5MDHoP8AYP8AQ1ylh8SNT0C7MGtIU28ENwf1r7N1n_j0b6V85fE__X23-5Wc8PGWp108XLkvY6HR_F-j6_CJLadAWHTIqO_eIodrhhXCeB_9afxr16X7grhnTs-U6qOL0ukeWsFQks4PP0qvNremWUW6edAR_DkV39__AKv8a88m_wCP6T6VpSw_NLluKeNtb3ShHq2r-IPKi0CDZE5wbmYbYlX1z3_CvR_Cvg2x8Plr6YtJqkq_vLs4K89owfujtXWeF_8AkXLD_rkK7KHon-6f512woxhsck8Q5bo808Qx7bUzsV3Aqc4A71wF1qJurpCSAqoT-Jr3XWv-PE_QV56f9b_wA1hWhqaRrLl2ODhuhDq0DuwXbIh5PHp_9avRv7dtf-esX51lXf8Aro_w_kaWkoHJKp5H_9nYGFjupGhkaWdlc3RJRBBmcmFuZG9tUFIctZA0R4rR_2URiSQlzVxxZWxlbWVudElkZW50aWZpZXJyZHJpdmluZ19wcml2aWxlZ2VzbGVsZW1lbnRWYWx1ZYKjdXZlaGljbGVfY2F0ZWdvcnlfY29kZWFBamlzc3VlX2RhdGXZA-xqMjAxOC0wOC0wOWtleHBpcnlfZGF0ZdkD7GoyMDI4LTA5LTAxo3V2ZWhpY2xlX2NhdGVnb3J5X2NvZGVhQmppc3N1ZV9kYXRl2QPsajIwMTctMDItMjNrZXhwaXJ5X2RhdGXZA-xqMjAyOC0wOS0wMdgYWF6kaGRpZ2VzdElEGBlmcmFuZG9tUP09TVag-Nw3joalEy_wikFxZWxlbWVudElkZW50aWZpZXJ2dW5fZGlzdGluZ3Vpc2hpbmdfc2lnbmxlbGVtZW50VmFsdWVjVVRP2BhYYqRoZGlnZXN0SUQNZnJhbmRvbVCb9nEQNlRYTqRdjKznaMu0cWVsZW1lbnRJZGVudGlmaWVydWFkbWluaXN0cmF0aXZlX251bWJlcmxlbGVtZW50VmFsdWVpMTIzNDU2Nzg52BhYR6RoZGlnZXN0SUQFZnJhbmRvbVCSg7oyrfEuXdOMBG8qpltxcWVsZW1lbnRJZGVudGlmaWVyY3NleGxlbGVtZW50VmFsdWUC2BhYS6RoZGlnZXN0SUQHZnJhbmRvbVAqIucKA0Yfu169v8Pk-t3ScWVsZW1lbnRJZGVudGlmaWVyZmhlaWdodGxlbGVtZW50VmFsdWUYr9gYWEykaGRpZ2VzdElEGCdmcmFuZG9tUBPN6UiWwhpX0FexSif9f2xxZWxlbWVudElkZW50aWZpZXJmd2VpZ2h0bGVsZW1lbnRWYWx1ZRhE2BhYUqRoZGlnZXN0SUQUZnJhbmRvbVBDNPDnNicJjo3AEoK1pF1ccWVsZW1lbnRJZGVudGlmaWVyamV5ZV9jb2xvdXJsZWxlbWVudFZhbHVlZGJsdWXYGFhUpGhkaWdlc3RJRAxmcmFuZG9tUFGv-JPdzDQ60eT_VSwnxcNxZWxlbWVudElkZW50aWZpZXJraGFpcl9jb2xvdXJsZWxlbWVudFZhbHVlZWJsb25k2BhYWqRoZGlnZXN0SUQSZnJhbmRvbVB-5HSbcnFwymy2Vff3GYgvcWVsZW1lbnRJZGVudGlmaWVya2JpcnRoX3BsYWNlbGVsZW1lbnRWYWx1ZWtTYW1wbGUgQ2l0edgYWI-kaGRpZ2VzdElEF2ZyYW5kb21QB4xNZgc5rYIeRQ7kchvY33FlbGVtZW50SWRlbnRpZmllcnByZXNpZGVudF9hZGRyZXNzbGVsZW1lbnRWYWx1ZXg6U2FtcGxlIFN0cmVldCAxMjMsIDEyMzQ1IFNhbXBsZSBDaXR5LCBTYW1wbGUgU3RhdGUsIFV0b3BpYdgYWGekaGRpZ2VzdElEGCZmcmFuZG9tUGogk3tnUPH7SXWi35VAJVpxZWxlbWVudElkZW50aWZpZXJ1cG9ydHJhaXRfY2FwdHVyZV9kYXRlbGVsZW1lbnRWYWx1ZdkD7GoyMDIwLTAzLTE02BhYUqRoZGlnZXN0SUQYLGZyYW5kb21QWXaiLE5cKAXYIVlDgPOCxHFlbGVtZW50SWRlbnRpZmllcmxhZ2VfaW5feWVhcnNsZWxlbWVudFZhbHVlGDbYGFhUpGhkaWdlc3RJRAhmcmFuZG9tUBd2z5KgZL-DX0YjzUl7XuJxZWxlbWVudElkZW50aWZpZXJuYWdlX2JpcnRoX3llYXJsZWxlbWVudFZhbHVlGQez2BhYUKRoZGlnZXN0SUQYI2ZyYW5kb21QhHY6OTxmrRy7LhRdEz00nXFlbGVtZW50SWRlbnRpZmllcmthZ2Vfb3Zlcl8xM2xlbGVtZW50VmFsdWX12BhYT6RoZGlnZXN0SUQVZnJhbmRvbVBw2Codrrp54WXUHePOm10ccWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzE2bGVsZW1lbnRWYWx1ZfXYGFhQpGhkaWdlc3RJRBgoZnJhbmRvbVDGrxSEfGJZBZUklMvarEyZcWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzE4bGVsZW1lbnRWYWx1ZfXYGFhQpGhkaWdlc3RJRBgrZnJhbmRvbVC84BWHBk7UQToJfI3sjOW6cWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzIxbGVsZW1lbnRWYWx1ZfXYGFhQpGhkaWdlc3RJRBgkZnJhbmRvbVDAn5ESz6csMDDsTebe_22ScWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzI1bGVsZW1lbnRWYWx1ZfXYGFhQpGhkaWdlc3RJRBgbZnJhbmRvbVC6aHpI_Egs-9OhRQEkMXILcWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzYwbGVsZW1lbnRWYWx1ZfTYGFhQpGhkaWdlc3RJRBghZnJhbmRvbVDlLfBNqvlXNFkxKWIfl0qucWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzYybGVsZW1lbnRWYWx1ZfTYGFhQpGhkaWdlc3RJRBgcZnJhbmRvbVA0CnVxwJjHBByaYCSqUtV3cWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzY1bGVsZW1lbnRWYWx1ZfTYGFhQpGhkaWdlc3RJRBglZnJhbmRvbVAEIE77UYkXUZ_u6bN31yvscWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzY4bGVsZW1lbnRWYWx1ZfTYGFhopGhkaWdlc3RJRBgeZnJhbmRvbVBt1WoBKCfFG_7to_d4RLwfcWVsZW1lbnRJZGVudGlmaWVydGlzc3VpbmdfanVyaXNkaWN0aW9ubGVsZW1lbnRWYWx1ZW9TdGF0ZSBvZiBVdG9waWHYGFhRpGhkaWdlc3RJRANmcmFuZG9tUIJDg5OVE1JqRIc81M-yKf5xZWxlbWVudElkZW50aWZpZXJrbmF0aW9uYWxpdHlsZWxlbWVudFZhbHVlYlpa2BhYXaRoZGlnZXN0SUQYIGZyYW5kb21Q5RWYWime_3mt7Z50SEyLB3FlbGVtZW50SWRlbnRpZmllcm1yZXNpZGVudF9jaXR5bGVsZW1lbnRWYWx1ZWtTYW1wbGUgQ2l0edgYWF6kaGRpZ2VzdElECWZyYW5kb21QGLa1WOROf6xZ6JghUIIXfnFlbGVtZW50SWRlbnRpZmllcm5yZXNpZGVudF9zdGF0ZWxlbGVtZW50VmFsdWVsU2FtcGxlIFN0YXRl2BhYXaRoZGlnZXN0SUQLZnJhbmRvbVABJ5jWvkk1TDnDtTk87yjscWVsZW1lbnRJZGVudGlmaWVydHJlc2lkZW50X3Bvc3RhbF9jb2RlbGVsZW1lbnRWYWx1ZWUxMjM0NdgYWFekaGRpZ2VzdElEGBpmcmFuZG9tUGx8bAfv31OK634uD5o3SyhxZWxlbWVudElkZW50aWZpZXJwcmVzaWRlbnRfY291bnRyeWxlbGVtZW50VmFsdWViWlrYGFhvpGhkaWdlc3RJRA5mcmFuZG9tUFoWxKEcxcIzZyVmCGgnj2dxZWxlbWVudElkZW50aWZpZXJ4HmZhbWlseV9uYW1lX25hdGlvbmFsX2NoYXJhY3RlcmxlbGVtZW50VmFsdWVs0JHQsNCx0ZbQsNC62BhYZ6RoZGlnZXN0SUQTZnJhbmRvbVDOKkChWWeSjHtxi8MHa-HZcWVsZW1lbnRJZGVudGlmaWVyeB1naXZlbl9uYW1lX25hdGlvbmFsX2NoYXJhY3RlcmxlbGVtZW50VmFsdWVlRXJpa2HYGFkWD6RoZGlnZXN0SUQYImZyYW5kb21Q44lsl9OTAHHYdFG0_O7gdXFlbGVtZW50SWRlbnRpZmllcnRzaWduYXR1cmVfdXN1YWxfbWFya2xlbGVtZW50VmFsdWVZFbT_2P_gABBKRklGAAEBAgA4ADgAAP_iD_BJQ0NfUFJPRklMRQABAQAAD-BhcHBsAhAAAG1udHJSR0IgWFlaIAfmAAgAHgAIACwAHWFjc3BBUFBMAAAAAEFQUEwAAAAAAAAAAAAAAAAAAAAAAAD21gABAAAAANMtYXBwbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEmRlc2MAAAFcAAAAYmRzY20AAAHAAAAEgmNwcnQAAAZEAAAAI3d0cHQAAAZoAAAAFHJYWVoAAAZ8AAAAFGdYWVoAAAaQAAAAFGJYWVoAAAakAAAAFHJUUkMAAAa4AAAIDGFhcmcAAA7EAAAAIHZjZ3QAAA7kAAAAMG5kaW4AAA8UAAAAPmNoYWQAAA9UAAAALG1tb2QAAA-AAAAAKHZjZ3AAAA-oAAAAOGJUUkMAAAa4AAAIDGdUUkMAAAa4AAAIDGFhYmcAAA7EAAAAIGFhZ2cAAA7EAAAAIGRlc2MAAAAAAAAACERpc3BsYXkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABtbHVjAAAAAAAAACYAAAAMaHJIUgAAABQAAAHYa29LUgAAAAwAAAHsbmJOTwAAABIAAAH4aWQAAAAAABIAAAIKaHVIVQAAABQAAAIcY3NDWgAAABYAAAIwZGFESwAAABwAAAJGbmxOTAAAABYAAAJiZmlGSQAAABAAAAJ4aXRJVAAAABQAAAKIZXNFUwAAABIAAAKccm9STwAAABIAAAKcZnJDQQAAABYAAAKuYXIAAAAAABQAAALEdWtVQQAAABwAAALYaGVJTAAAABYAAAL0emhUVwAAAAoAAAMKdmlWTgAAAA4AAAMUc2tTSwAAABYAAAMiemhDTgAAAAoAAAMKcnVSVQAAACQAAAM4ZW5HQgAAABQAAANcZnJGUgAAABYAAANwbXMAAAAAABIAAAOGaGlJTgAAABIAAAOYdGhUSAAAAAwAAAOqY2FFUwAAABgAAAO2ZW5BVQAAABQAAANcZXNYTAAAABIAAAKcZGVERQAAABAAAAPOZW5VUwAAABIAAAPecHRCUgAAABgAAAPwcGxQTAAAABIAAAQIZWxHUgAAACIAAAQac3ZTRQAAABAAAAQ8dHJUUgAAABQAAARMcHRQVAAAABYAAARgamFKUAAAAAwAAAR2AEwAQwBEACAAdQAgAGIAbwBqAGnO7LfsACAATABDAEQARgBhAHIAZwBlAC0ATABDAEQATABDAEQAIABXAGEAcgBuAGEAUwB6AO0AbgBlAHMAIABMAEMARABCAGEAcgBlAHYAbgD9ACAATABDAEQATABDAEQALQBmAGEAcgB2AGUAcwBrAOYAcgBtAEsAbABlAHUAcgBlAG4ALQBMAEMARABWAOQAcgBpAC0ATABDAEQATABDAEQAIABjAG8AbABvAHIAaQBMAEMARAAgAGMAbwBsAG8AcgBBAEMATAAgAGMAbwB1AGwAZQB1AHIgDwBMAEMARAAgBkUGRAZIBkYGKQQaBD4EOwRMBD4EQAQ-BDIEOAQ5ACAATABDAEQgDwBMAEMARAAgBeYF0QXiBdUF4AXZX2mCcgBMAEMARABMAEMARAAgAE0A4AB1AEYAYQByAGUAYgBuAP0AIABMAEMARAQmBDIENQRCBD0EPgQ5ACAEFgQaAC0ENAQ4BEEEPwQ7BDUEOQBDAG8AbABvAHUAcgAgAEwAQwBEAEwAQwBEACAAYwBvAHUAbABlAHUAcgBXAGEAcgBuAGEAIABMAEMARAkwCQIJFwlACSgAIABMAEMARABMAEMARAAgDioONQBMAEMARAAgAGUAbgAgAGMAbwBsAG8AcgBGAGEAcgBiAC0ATABDAEQAQwBvAGwAbwByACAATABDAEQATABDAEQAIABDAG8AbABvAHIAaQBkAG8ASwBvAGwAbwByACAATABDAEQDiAOzA8cDwQPJA7wDtwAgA78DuAPMA70DtwAgAEwAQwBEAEYA5AByAGcALQBMAEMARABSAGUAbgBrAGwAaQAgAEwAQwBEAEwAQwBEACAAYQAgAEMAbwByAGUAczCrMOkw_ABMAEMARAAAdGV4dAAAAABDb3B5cmlnaHQgQXBwbGUgSW5jLiwgMjAyMgAAWFlaIAAAAAAAAPMWAAEAAAABFspYWVogAAAAAAAAccAAADmKAAABZ1hZWiAAAAAAAABhIwAAueYAABP2WFlaIAAAAAAAACPyAAAMkAAAvdBjdXJ2AAAAAAAABAAAAAAFAAoADwAUABkAHgAjACgALQAyADYAOwBAAEUASgBPAFQAWQBeAGMAaABtAHIAdwB8AIEAhgCLAJAAlQCaAJ8AowCoAK0AsgC3ALwAwQDGAMsA0ADVANsA4ADlAOsA8AD2APsBAQEHAQ0BEwEZAR8BJQErATIBOAE-AUUBTAFSAVkBYAFnAW4BdQF8AYMBiwGSAZoBoQGpAbEBuQHBAckB0QHZAeEB6QHyAfoCAwIMAhQCHQImAi8COAJBAksCVAJdAmcCcQJ6AoQCjgKYAqICrAK2AsECywLVAuAC6wL1AwADCwMWAyEDLQM4A0MDTwNaA2YDcgN-A4oDlgOiA64DugPHA9MD4APsA_kEBgQTBCAELQQ7BEgEVQRjBHEEfgSMBJoEqAS2BMQE0wThBPAE_gUNBRwFKwU6BUkFWAVnBXcFhgWWBaYFtQXFBdUF5QX2BgYGFgYnBjcGSAZZBmoGewaMBp0GrwbABtEG4wb1BwcHGQcrBz0HTwdhB3QHhgeZB6wHvwfSB-UH-AgLCB8IMghGCFoIbgiCCJYIqgi-CNII5wj7CRAJJQk6CU8JZAl5CY8JpAm6Cc8J5Qn7ChEKJwo9ClQKagqBCpgKrgrFCtwK8wsLCyILOQtRC2kLgAuYC7ALyAvhC_kMEgwqDEMMXAx1DI4MpwzADNkM8w0NDSYNQA1aDXQNjg2pDcMN3g34DhMOLg5JDmQOfw6bDrYO0g7uDwkPJQ9BD14Peg-WD7MPzw_sEAkQJhBDEGEQfhCbELkQ1xD1ERMRMRFPEW0RjBGqEckR6BIHEiYSRRJkEoQSoxLDEuMTAxMjE0MTYxODE6QTxRPlFAYUJxRJFGoUixStFM4U8BUSFTQVVhV4FZsVvRXgFgMWJhZJFmwWjxayFtYW-hcdF0EXZReJF64X0hf3GBsYQBhlGIoYrxjVGPoZIBlFGWsZkRm3Gd0aBBoqGlEadxqeGsUa7BsUGzsbYxuKG7Ib2hwCHCocUhx7HKMczBz1HR4dRx1wHZkdwx3sHhYeQB5qHpQevh7pHxMfPh9pH5Qfvx_qIBUgQSBsIJggxCDwIRwhSCF1IaEhziH7IiciVSKCIq8i3SMKIzgjZiOUI8Ij8CQfJE0kfCSrJNolCSU4JWgllyXHJfcmJyZXJocmtyboJxgnSSd6J6sn3CgNKD8ocSiiKNQpBik4KWspnSnQKgIqNSpoKpsqzysCKzYraSudK9EsBSw5LG4soizXLQwtQS12Last4S4WLkwugi63Lu4vJC9aL5Evxy_-MDUwbDCkMNsxEjFKMYIxujHyMioyYzKbMtQzDTNGM38zuDPxNCs0ZTSeNNg1EzVNNYc1wjX9Njc2cjauNuk3JDdgN5w31zgUOFA4jDjIOQU5Qjl_Obw5-To2OnQ6sjrvOy07azuqO-g8JzxlPKQ84z0iPWE9oT3gPiA-YD6gPuA_IT9hP6I_4kAjQGRApkDnQSlBakGsQe5CMEJyQrVC90M6Q31DwEQDREdEikTORRJFVUWaRd5GIkZnRqtG8Ec1R3tHwEgFSEtIkUjXSR1JY0mpSfBKN0p9SsRLDEtTS5pL4kwqTHJMuk0CTUpNk03cTiVObk63TwBPSU-TT91QJ1BxULtRBlFQUZtR5lIxUnxSx1MTU19TqlP2VEJUj1TbVShVdVXCVg9WXFapVvdXRFeSV-BYL1h9WMtZGllpWbhaB1pWWqZa9VtFW5Vb5Vw1XIZc1l0nXXhdyV4aXmxevV8PX2Ffs2AFYFdgqmD8YU9homH1YklinGLwY0Njl2PrZEBklGTpZT1lkmXnZj1mkmboZz1nk2fpaD9olmjsaUNpmmnxakhqn2r3a09rp2v_bFdsr20IbWBtuW4SbmtuxG8eb3hv0XArcIZw4HE6cZVx8HJLcqZzAXNdc7h0FHRwdMx1KHWFdeF2Pnabdvh3VnezeBF4bnjMeSp5iXnnekZ6pXsEe2N7wnwhfIF84X1BfaF-AX5ifsJ_I3-Ef-WAR4CogQqBa4HNgjCCkoL0g1eDuoQdhICE44VHhauGDoZyhteHO4efiASIaYjOiTOJmYn-imSKyoswi5aL_IxjjMqNMY2Yjf-OZo7OjzaPnpAGkG6Q1pE_kaiSEZJ6kuOTTZO2lCCUipT0lV-VyZY0lp-XCpd1l-CYTJi4mSSZkJn8mmia1ZtCm6-cHJyJnPedZJ3SnkCerp8dn4uf-qBpoNihR6G2oiailqMGo3aj5qRWpMelOKWpphqmi6b9p26n4KhSqMSpN6mpqhyqj6sCq3Wr6axcrNCtRK24ri2uoa8Wr4uwALB1sOqxYLHWskuywrM4s660JbSctRO1irYBtnm28Ldot-C4WbjRuUq5wro7urW7LrunvCG8m70VvY--Cr6Evv-_er_1wHDA7MFnwePCX8Lbw1jD1MRRxM7FS8XIxkbGw8dBx7_IPci8yTrJuco4yrfLNsu2zDXMtc01zbXONs62zzfPuNA50LrRPNG-0j_SwdNE08bUSdTL1U7V0dZV1tjXXNfg2GTY6Nls2fHadtr724DcBdyK3RDdlt4c3qLfKd-v4DbgveFE4cziU-Lb42Pj6-Rz5PzlhOYN5pbnH-ep6DLovOlG6dDqW-rl63Dr--yG7RHtnO4o7rTvQO_M8Fjw5fFy8f_yjPMZ86f0NPTC9VD13vZt9vv3ivgZ-Kj5OPnH-lf65_t3_Af8mP0p_br-S_7c_23__3BhcmEAAAAAAAMAAAACZmYAAPKnAAANWQAAE9AAAApbdmNndAAAAAAAAAABAAEAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAQAAbmRpbgAAAAAAAAA2AACnQAAAVYAAAEzAAACewAAAJYAAAAzAAABQAAAAVEAAAjMzAAIzMwACMzMAAAAAAAAAAHNmMzIAAAAAAAEMcgAABfj___MdAAAHugAA_XL___ud___9pAAAA9kAAMBxbW1vZAAAAAAAAAYQAACgLwAAAADQ5d_wAAAAAAAAAAAAAAAAAAAAAHZjZ3AAAAAAAAMAAAACZmYAAwAAAAJmZgADAAAAAmZmAAAAAjMzNAAAAAACMzM0AAAAAAIzMzQA_9sAQwAFAwQEBAMFBAQEBQUFBgcMCAcHBwcPCwsJDBEPEhIRDxERExYcFxMUGhURERghGBodHR8fHxMXIiQiHiQcHh8e_8AACwgANwB4AQERAP_EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC__EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29_j5-v_aAAgBAQAAPwD7LoozRRRRRRRRRRRRRXM3uoa3rN5NY-HWgs7WB2iuNUnj8z5xwyQx5AZgeC7Hap4w5DASQ-EbMgtf6prmoTE5Msupyx_kkRRF_BRR4QmcX-sadFeT31jZTpHFNO_mOjlcyRbzy4T5eTkgsVJO3joqKKKKKKKKKKK43Tb678IW39matp1xLpUBbyNTtUMqiMkkCeNfnRhnlwGU43ErnA6yxurW-tIruyuIbm2mUPFLE4dHU9CCOCPeqwfTdGgtLKKJbaKWbyYI4ojt3kM38I4zhjk4Ge-TV4soxkgZ4GaSKSOVN8bq65IypyODg_rUK31m08cAu4DLLu8tBINz7ThsDPOO-OlTsyqMsQB7024j823kiEjx71K70OGXPcH1rgrGx1nUvFt5PpfiGb7Fop-yxLfRC4jkuWUGU_KUYhFKICWPLSeldVokesG5ml1TVLK4CDyxBaW5jVG6ksWZmLYxxwAD3zmtamQyxzIJInV0PRlOQacGBJAIyOopaKgv7u1sbSS6vJ47eCMZeSRtqr-Nef8AgsalN4h8UQ-G4l0zRnvY5A93C2UuGiDT-VDxtDZjY7iMOzkqSTWkNO1zSvF8-oouq64r6ekFsZbyOOGOUyMZS68BMgRYKoxwD361NY0Hyb8a54r1pbp5NkcNtBandG_J8q2wS2WOCWA8w4-8qgBamn2niS68H6xJoCrpUU1zc_2bZQFA6sW2AvIMrGocM5CAnGcNniraeEG0FvD39maadTksCzz3BZEkeRYWjjBZjlY_3kjELuOecMWYm5qvhHVdavYr7WNWgfZGwSxW2DwQMT95N_WTHy73VsAnaqZOavhCDxFp3gu00i2sr6G8hgL31_qLiWWSc5aQoNxMjFycFiFAx97G2ofBV1ep4K0zRfDrG81FrcS3-p3CloYp5P3krMePMlLs3yL0P3tvAMWl2Piq0-Hsui-HrKew1j7JLJc6nf8All5r11Jd1UEh3aQk7mwgGMBgNtXtUi8V3Hg1tI8MW91pLx2qW0N5fyLJc7jhN-NzD5cl2diScEBSSCL-meC4dD01YdB1LUbOdLYRMfPDpOyrhWdZFZVPHJUA446AVjeCPDmr6XbyG2tr2DVLyJP7R1XVrlZ5Hk5LGONGIPzE4yVVRgAEALXfafbfZLOK28-ecxrgyzPudz3JPqfbA9ABU9cBYag_iF01Cz8u_wBRkJa0jYbrbSkJIDy44M2OSv3snaNq7mPZaJpsGlabHZwF32ktJI5y8rsSXdj3ZmJJ-tJrmpwaVpz3cyvIchIooxl5pGOFRR3JPHp3OACa5HW_t9p9njEqTeL9aDQWrKN0enxcGV0B6JGpBLdZHKA43KF7LSbG30zS7bTrRSsFtEsUYJydqjAye545NWqKKKKKKKKKAAOgorlfEsl7D4ntbpNJvdSW3tWNjFCAENw5KszuThNqcBj2d8AnirfhfQprK4uNY1eaO71u9AWeVAfLhjBJWCIHkRrknJ5ZiWPUAb9FFFFFFFFFFFFFFFFFFFFFFFFf_9l3b3JnLmlzby4xODAxMy41LjEuYWFtdmGG2BhYUKRoZGlnZXN0SUQYKmZyYW5kb21QKCHAaCNryJQoR--nwDMOt3FlbGVtZW50SWRlbnRpZmllcmtvcmdhbl9kb25vcmxlbGVtZW50VmFsdWUB2BhYUaRoZGlnZXN0SUQYKWZyYW5kb21QXsuIGmMNFxegjDpha4cRKHFlbGVtZW50SWRlbnRpZmllcmx3ZWlnaHRfcmFuZ2VsZWxlbWVudFZhbHVlA9gYWFSkaGRpZ2VzdElEGB1mcmFuZG9tUIn6MXjmw-UcLPMAWLw4JTFxZWxlbWVudElkZW50aWZpZXJucmFjZV9ldGhuaWNpdHlsZWxlbWVudFZhbHVlYVfYGFhTpGhkaWdlc3RJRApmcmFuZG9tUAjj4XF0U3aQ6ylYd-g0pZhxZWxlbWVudElkZW50aWZpZXJuREhTX2NvbXBsaWFuY2VsZWxlbWVudFZhbHVlYUbYGFhSpGhkaWdlc3RJRABmcmFuZG9tUM9RBFlpmZAjm9cvkpfl2q5xZWxlbWVudElkZW50aWZpZXJuRURMX2NyZWRlbnRpYWxsZWxlbWVudFZhbHVlAdgYWEekaGRpZ2VzdElEAWZyYW5kb21QGg9yK3OzGbnAKccy0kLM33FlbGVtZW50SWRlbnRpZmllcmNzZXhsZWxlbWVudFZhbHVlAmppc3N1ZXJBdXRohEOhASahGCFZAq0wggKpMIICUKADAgECAhQSZy0eDPFIaqTpnwRv7Sz3tVl2mjAKBggqhkjOPQQDAjCBhzELMAkGA1UEBhMCVVMxGDAWBgNVBAgMD1N0YXRlIG9mIFV0b3BpYTESMBAGA1UEBwwJU2FuIFJhbW9uMRowGAYDVQQKDBFPcGVuSUQgRm91bmRhdGlvbjELMAkGA1UECwwCSVQxITAfBgNVBAMMGGNlcnRpZmljYXRpb24ub3BlbmlkLm5ldDAeFw0yNTA3MzAwNzQ3MjJaFw0yNjA3MzAwNzQ3MjJaMIGHMQswCQYDVQQGEwJVUzEYMBYGA1UECAwPU3RhdGUgb2YgVXRvcGlhMRIwEAYDVQQHDAlTYW4gUmFtb24xGjAYBgNVBAoMEU9wZW5JRCBGb3VuZGF0aW9uMQswCQYDVQQLDAJJVDEhMB8GA1UEAwwYY2VydGlmaWNhdGlvbi5vcGVuaWQubmV0MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEnmiWAMGIeo2E3usWRLL_EPfh1Bw5JHgq8RYzJvraMj5QZSh94CL_nlEi3vikGxDP34HjxZcjzGEimGg03sB6NqOBlzCBlDASBgNVHRMBAf8ECDAGAQH_AgEAMA4GA1UdDwEB_wQEAwIBBjAhBgNVHRIEGjAYgRZjZXJ0aWZpY2F0aW9uQG9pZGYub3JnMCwGA1UdHwQlMCMwIaAfoB2GG2h0dHA6Ly9leGFtcGxlLmNvbS9teWNhLmNybDAdBgNVHQ4EFgQUeGT0tVUfwa31mB_GDKFKX3bVc6EwCgYIKoZIzj0EAwIDRwAwRAIgIHGMKr158DAwpEQr6TQ5cG2JAJsUPtB2nIfjYtVh928CIC6uVnCn0-2ZBnOhJgNS9elkzm9O8UtVzgRIbLcC10L6WQez2BhZB66mZ3ZlcnNpb25jMS4wb2RpZ2VzdEFsZ29yaXRobWdTSEEtMjU2Z2RvY1R5cGV1b3JnLmlzby4xODAxMy41LjEubURMbHZhbHVlRGlnZXN0c6Jxb3JnLmlzby4xODAxMy41LjG4KA9YIPWsk3LQOp0H_jj-opmwYabBIqkVtld_R94Bm1P9HxbpAlggh3g2rZy-P5_pxeycvFg3BmMrewNULZZZVRzkXHhEcZ8GWCDI_KJDBGFCcfBX99rajq3-0gRuBvcnv-4aSYXH6-5xpxFYIJj51DqZdmr7bFBna0SPW7nHpy-K1reA978yUYrL4UDFFlggjr3v0zSw8-droh8rzSJDdNrVjj-CfHy1c2VkILBJW84YGFggt5o0qVRo3lkcgkaVBF0mdI_Vr_tVJ_Os-3x_45dJfoUYH1ggarCImrCxGbShclQlVYcKSIyiZwgVl5INW4mpBZCTwsIEWCAf3pS7-cTJq2Ol75y7YDweiwo-7Te0z0HQsSgELsTemRgtWCAG4uUUDA5hWcdngJoVFMJRnlYe7r1yU8iMi17lfZrQiBBYIBbTkWQX0HEEVW-_jmrNdO2otP3b8za2AmFecdW4qh63GBlYIAFKxz6ViizZZoG4E1BxkqJ2JfTvKqP2V0vSsVQWVfQyDVggJivOie_raoq0E_bf7hJkROSVSA8wt-au9ezehCqU9SYFWCBp-7LPR4jhRYT43KwqVC4adQ-HDtx8F5MQ6nTzSFuyjQdYIENtnbZV2INN73t1XPXXlsy46Vj2aWbmwesdZ4xua9QVGCdYID-X4NRGeLdooYyw6dN-UiYwQE1sejq6nVbeMDeAumSlFFggPOQYs15eAEbOPXVV11kEvLNsXOnjndChgj1D-2tsyxAMWCBaa0Hs8TuarG9kcche9Fdf3D0SDpNiOGUf19oWL3-zThJYIElfteVRZMAWLNLlEq4Wt_tX7I3uDOSFdBNYDH8KlGPyF1gg5_eAnGMZX61z6q2FqXqC3nzezz0LSx-kGXG2ZTLVyqAYJlggd7oO14OHeM3OqAX8fKAVs5P4A4PZ8wdK0o23ryYQbRkYLFggvAwGZjGNpBY1_3SXVN8GMwkfqi10JyiA01RIAZyP_cQIWCCvHlpa0y71IJdBu7DE52tLEb7W_dm4COaiv6tZq7wmiRgjWCB4bKgO5j866ll9es0e0SEuCvARm_XhJTDjmhAAmt_VGhVYIJa8UO0XH8-WtEhzH2kVqVgInkYu3JRATYvlzf8DbRoOGChYINpj_s1CkFCtMUiFIZWZhBOUJzpN-DfzY_8B57GuQtdZGCtYIHb9hsgLQsIr1xB7uc4bdjnoEf3Nf9Gyq3l5Gpt9qQD-GCRYIFkzhrgTocULkLhwklUSyLJ88ps-pJCdbcZKBWilVq2FGBtYINO-qLal9xZ4icqRvZQg7xyzTeWSN6QRPaSS7eUtsIwPGCFYINwRivf-IWbfxOgaK8D3FR7x6dmJkMQ85cQe2xW3dLN8GBxYINc7QfFPUYecQkrg7bgsvoHbaji3Ai2JCYtlPsDj_oLqGCVYIBYx59QIq0CBIdLb30F4lA_YXVXNbSLlRzFNHywVrEHdGB5YIAZ6F0aeAN9uKsWQCWfyFaBEZj03WaXKJErKepZBNqAmA1ggEGsgECAWjIFZpsxu6zB_ehD7mk58IQj4lBNjs8fvTM0YIFggG4uvAv_YNUKa03ZKGbnM5rRXVDBBe4Sass3ev8JFfJEJWCBQ0h2Tzk5egPenI-1wlJ2E3Z3HIFg-sAEwSMx-q2Ib-AtYIKlC93P4AX1Sex1lZFLBOSraTs3STYfwUPsjllsS9v_CGBpYILZCOrP66z2o-TEUSCvbcPy-ZVQqiuo22JlxLAAxwqATDlggtebUHX2sIMr9KUX0dKsMMOeo95kDL79Utun1nohwOm4TWCAnknBK8gaSR2h4KWTbtgfS_SKXrX8x6uMpVqCHOMQtihgiWCABiG6BNqeuCKtPlMLS3P1MQ-keOFfZcab3Nhtfn_fbq3dvcmcuaXNvLjE4MDEzLjUuMS5hYW12YaYYKlggHKr5grXD8VTx9jz_iObwz94yLOeLG9-e82w1G1Pq-gwYKVggFifscwxCGnN_mXyw_GoBckJPn0NTTda9f42QQse9MaMYHVgg4flIHLO8MtwQvAUrFA7S4qldXBGbR7vhh2O1Kum6IkoKWCAK5Jg7yr7wEzyjQKL8TjBv-hM3O3gWC8i7QCXrkTITcwBYIAmiVOi5_CQKzqm7xQM9KuxEdSzfOGIek7hpJsHs35krAVgggS7TTvNilfAQPUBPI1vgRq6kJs8EpfJEPt2nJCVF9odtZGV2aWNlS2V5SW5mb6FpZGV2aWNlS2V5pAECIAEhWCCJqfQFzruLfn7N489tXtGm-tUDLxDRRvJPGUjKlLA_EyJYIOs6l5LacG53jTw_Flmp3C_MvWVJTOq5C00m8NLn3pKsbHZhbGlkaXR5SW5mb6Nmc2lnbmVkwHQyMDI1LTEwLTE1VDAyOjQyOjQyWml2YWxpZEZyb23AdDIwMjUtMTAtMTVUMDI6NDI6NDJaanZhbGlkVW50aWzAdDIwMjYtMTAtMTVUMDM6NDI6NDJaWECwO5O2eGOYylgLt4pHJNpVmClbRJRHkLl-RA2h2LJKYi9FIPERCIM6ABt-AtZs99fBnonFGStxDAFBTOMpL1U2bGRldmljZVNpZ25lZKJqbmFtZVNwYWNlc9gYQaBqZGV2aWNlQXV0aKFvZGV2aWNlU2lnbmF0dXJlhEOhASag9lhATtY5_J0fcVYfv_nEQNjvisoKad-VKMD-054GzTFmYyXMG-DK998_j4cmWts1J25GD1IASvH1aOfMTZtThktlUGZzdGF0dXMA"

        private const val clientId = "x509_san_dns:verifier.example.com"
        private const val nonce = "ed441c8c-428e-4b9a-807b-b3873f82e03e"
        private val jwkThumbprint = null
        private const val responseUri = "https://verifier2.localhost/verification-session/9e1f6432-338b-4938-9339-2c194bc76ef4/response"
        private val verificationContext = MdocVerificationContext(nonce, clientId, responseUri)
    }

    @Test
    fun verifyConformanceMdocSignature() = runTest {
        println("==== VERIFICATION: Mdoc Device Signature ====")
        val document = MdocParser.parseToDocument(vpTokenMdocBase64)
        val mso = document.issuerSigned.decodeMobileSecurityObject()
        val sessionTranscript = MdocCryptoHelper.reconstructOid4vpSessionTranscript(verificationContext)

        println("--- Verifying device authentication ---")

        val deviceSigned = document.deviceSigned ?: throw IllegalArgumentException("DeviceSigned structure is missing.")
        println("Device signed: $deviceSigned")


        val devicePublicKey = JWKKey.importJWK(mso.deviceKeyInfo.deviceKey.toJWK().toString()).getOrThrow()
        println("Device public key: $devicePublicKey")

        val deviceAuth = deviceSigned.deviceAuth
        println("Device auth (of device signed): $deviceAuth")

        val deviceAuthBytes = MdocCryptoHelper.buildDeviceAuthenticationBytes(
            sessionTranscript,
            document.docType,
            deviceSigned.namespaces
        )
        println("Device auth bytes (hex): ${deviceAuthBytes.toHexString()}")

        println("Device auth contains device signature: ${deviceAuth.deviceSignature}")

        val verifyResult = MdocCrypto.verifyDeviceSignature(
            payloadToVerify = deviceAuthBytes,
            deviceSignature = deviceAuth.deviceSignature!!,
            sDevicePublicKey = devicePublicKey
        )
        println("Key (from MSO): $verifyResult")

        require(verifyResult) { "Failed verifying device signature" }
    }

    @Test
    fun verifyConformanceMdoc() = runTest {
        println("==== VERIFICATION: MdocVerifier ====")
        val verificationResult = MdocVerifier.verify(vpTokenMdocBase64, verificationContext)
        println("Verification result: $verificationResult")

        assertTrue("Verification result is not valid") { verificationResult.valid }
    }

}
